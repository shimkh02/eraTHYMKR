;매춘 관계의 처리를 모아두고 잇습니다.

;변수 개조 계획. 내역은 이하대로 솔까말, T:XX의 변경이 제일 번거로움
;또, 매출 결과 판정 중에는 변수 B,C,D,E,F,G,R 및 A:0～A:3,T:0～T:99,R:0～R:4를 사용하고 있습니다.
;A：만족 결과				→LOCAL@SPRING_DUMMY:0
;B：각종 잡무 계산			→LOCAL@SPRING_DUMMY:1
;C：단골 손님 판정				→LOCAL@SPRING_DUMMY:2
;D：만족도 계산				→LOCAL@SPRING_DUMMY:3
;E：V, A경험 등의 체크	→LOCAL@SPRING_DUMMY:4
;F：체력 소모 함수			→LOCAL@SPRING_DUMMY:5
;G：내객자 숫자				→LOCAL@SPRING_DUMMY:6
;T：경험수					→	LOCAL@SPRING_EXP:XX
;R：세트 매춘시에 사용		→LOCAL@SPRING_7TH:XX
@SPRING_DUMMY
;변수 확보 함수
@SPRING_TIME

;오프 시에는 일절 하지 않습니다
IF FLAG:13 & 1024
	PRINTL 
ELSE
	RETURN 0
ENDIF

;버그 회피를 위한 처리입니다
SIF TARGET == -1
	TARGET = 0
	
IF TIME == 0
	CALL SPRING_LUNCH_TIME
ELSE
	CALL SPRING_RESULT
	CALL SPRING_RANKING_GROW
ENDIF
;버그 회피를 위한 처리입니다
SIF TARGET == 0
	TARGET = -1

;지나친 인플레이션 회피입니다
IF FLAG:3000 & 8388608
	REPEAT CHARANUM
		SIF EXP:COUNT:77 >= 1000000
			EXP:COUNT:77 = 1000000
	REND
ENDIF

DRAWLINE

@SPRING_LUNCH_TIME
;낮의 랜덤 이벤트입니다
LOCAL@SPRING_DUMMY:0 = 0
REPEAT CHARANUM
;매춘을 하지 않는 사람(24이 0인 사람)은 무시합니다
SIF CFLAG:COUNT:1501 == 0
	CONTINUE
LOCAL@SPRING_DUMMY:0 += 1
LOCAL@SPRING_EXP:(LOCAL@SPRING_DUMMY:0) = COUNT
REND

SIF LOCAL@SPRING_DUMMY:0 == 0
	RETURN 0

DRAWLINE
$SPRING_LOOP
LOCAL@SPRING_DUMMY:1 = RAND:30
LOCAL@SPRING_DUMMY:1 += 1

SIF LOCAL@SPRING_DUMMY:1 > LOCAL@SPRING_DUMMY:0
	GOTO SPRING_LOOP

COUNT = LOCAL@SPRING_EXP:(LOCAL@SPRING_DUMMY:1)

LOCAL@SPRING_DUMMY:4 = 0

IF 1 == 0
;더미 분기얌. 미안혀.
ELSEIF RAND:6 == 0 && ABL:COUNT:70 >= 3 && ABL:COUNT:10 >= 3
	;알몸 앞치마 분투기
	PRINTFORMW 『『잘먹겠습니다―』』
	IF RAND:3 == 0
		PRINTFORMW 『이야, 맛있어라―! 과연 %CALLNAME:COUNT%인데!』
	ELSEIF RAND:2 == 0
		PRINTFORMW 『과연 %CALLNAME:COUNT% 씨의 요리. 맛의 차원이 다른데』
	ELSE
		;자중할 수 없었다
		PRINTFORMW 『햣하아―! 물이다―! 음식이다―! 맛있어어―!』
	ENDIF
	CALL SELF_KOJO,COUNT,1300
	PRINTFORMW 창관 종업원들의 오늘 점심식사는 %조사처리(CALLNAME:COUNT,"가")% 알몸 에이프런을 입고 직접 만든 요리였다.
	PRINTFORMW 종업원들은 조금 건강해졌다.
	EXP:COUNT:70 += 1
	LOCAL@SPRING_DUMMY:0 = ABL:COUNT:70
	LOCAL@SPRING_DUMMY:0 *= 50
	REPEAT CHARANUM
	;매춘을 하지 않는 사람은 무시합니다
	SIF CFLAG:COUNT:1501 != 1024
		CONTINUE
	BASE:COUNT:0 += LOCAL@SPRING_DUMMY:0
	SIF BASE:COUNT:0 > MAXBASE:COUNT:0
		BASE:COUNT:0 = MAXBASE:COUNT:0
	REND

ELSEIF RAND:5 == 0 && ABL:COUNT:10 >= 3 && ABL:COUNT:14 >= 3
	;약간의 선전
	PRINTFORML 『자아 자아, %CALLNAME:MASTER% 창관, 영업중입니다!』
	IF TALENT:COUNT:120
		PRINTL 「지금이라면 이렇게 멋진 남자가 잔뜩 봉사해 준답니다!」
	ELSE
		PRINTL 『지금이라면 이렇게나 귀여운 애가 잔뜩 봉사해 준답니다!』
	ENDIF
	CALL SELF_KOJO, COUNT, 1200
	PRINTFORMW %조사처리(CALLNAME:COUNT,"는")% 조금 부끄러운 차림을 하고 찌라시를 뿌리고 다녔다.
	IF RAND:10 == 0
		PRINTFORMW 선전 덕분에 창관의 인기가 조금 오른 것 같다.
		FLAG:3005 += 1
		SIF FLAG:3005 > 100 && (FLAG:3000 & 8388608) == 0
			FLAG:3005 = 100
	ELSEIF RAND:10 <= ABL:COUNT:14
		PRINTFORMW 선전 덕분에 %CALLNAME:COUNT%의 인기가 조금 오른 듯하다.
		EXP:COUNT:77 += 1
		SIF EXP:COUNT:77 > 100 && (FLAG:3000 & 8388608) == 0
			EXP:COUNT:77 = 100
	ENDIF
ELSE
	;창관에서의 자주 있는 교환.
	PRINTL 『어서옵쇼―. 싸게 해 드립죠!』
	PRINTW 『엥? 이 애를 지명? 이야 이거 참 안목이 높으신데!』
	IF TALENT:COUNT:120
		PRINTFORML 「%CALLNAME:COUNT% 군, 지명 들어왔어요―!」
	ELSE
		PRINTFORML 『%CALLNAME:COUNT%쨩, 지명 들어왔어요―!』
	ENDIF
	CALL SELF_KOJO, COUNT, 1100
	PRINTW 오늘도 창관은 나름대로 번성 중인 모양이다.
ENDIF

LOCAL@SPRING_DUMMY:0 = 0
LOCAL@SPRING_DUMMY:1 = 0

REPEAT CHARANUM
	LOCAL@SPRING_EXP:COUNT = 0
REND


;매춘에서는, 「가게의 인기에 응한 손님」＋「캐릭터의 인기에 응한 손님」＋「단골손님」의 손님이 방문합니다.
;「손님이 방문한 수」×「매춘 기준가격」×「만족도 보정(최저 1, 스핀이라든지의 분으로 생각해 주세요)」의 돈이 손에 들어 옵니다.
;
;만족도는 대표가 되는 손님 한사람에 의해 계산됩니다.
;덧붙여서, 단골 손님수×10%의 확률로 단골손님의 사람이 옵니다
;단골손님이 아닌 사람이 왔을 때에 높은 만족도를 내쫓으면(자) 단골손님이 증가합니다.
;
;만족도에 응해, 가게의 인기와 캐릭터의 인기가 증감합니다.
;가게의 인기는 전캐릭터의 합계분이라도 있으므로, 증가율, 하강율 모두 낮은입니다.
;덧붙여 가게의 인기는 「당신」의 인기로서 취급합니다.


@SPRING_RESULT
;매춘 결과 하고 있는 사람을 찾습니다. 그것 뿐입니다.
;세트 매춘을 위해서(때문에) 사용됩니다
LOCAL@SPRING_7TH:0 = -1
LOCAL@SPRING_7TH:1 = -1
DRAWLINE
REPEAT CHARANUM
;매춘을 실시하지 않은 사람(24가 0의 사람)은 스르 합니다
SIF CFLAG:COUNT:1501 == 0
	CONTINUE
CALL SPRING_MAIN
REND

IF LOCAL@SPRING_7TH:1 != -1
	CALL SPRING_7TH
ENDIF
IF FLAG:3004
	CALL SPRING_8TH
ENDIF

REPEAT CHARANUM
	SIF CHARANUM == COUNT
		BREAK
	SIF BASE:COUNT:0 > 0
		CONTINUE
	CALL SPRING_CHARA_GONE, COUNT, TARGET, ASSI
	COUNT -= 1
REND

SIF FLAG:3 != 3 || DAY >= 99
	RETURN 0

;창관의 인기 자연 감소(H전용 처리)
SIF DAY / 30 > 0
	PRINTFORM 【자연 감소】 창관인기 {FLAG:3005} →
FLAG:3005 -= DAY / 30
SIF DAY / 30 > 0
	PRINTFORMW  {FLAG:3005}


@SPRING_MAIN
;COUNT가 그 캐릭터의 번호이므로, 이 이후 COUNT는 보존할 필요가 있습니다.
;여기가 매춘의 근간 부분입니다. 여기로부터 각 함수에 납니다.
;xth→HAPPY→EXP→MONEY→DOWN→BASE의 순서에 처리됩니다.

;T:XX는 경험이나 매각액 등에 사용됩니다.
LOCAL@SPRING_DUMMY:0 = COUNT
REPEAT 100
	LOCAL@SPRING_EXP:COUNT = 0
REND
COUNT = LOCAL@SPRING_DUMMY:0
;A는 여러가지 변수에 이용됩니다. HAPPY로부터, MONEY의 사이는, 고객의 만족도로서 기능하기 때문에, 이전은 조작 해서는 안됩니다.
LOCAL@SPRING_DUMMY:0 = 0
;B는 여러가지 변수에 이용됩니다.
LOCAL@SPRING_DUMMY:1 = 0
;C는, 단골손님인가 어떤가의 체크에 사용됩니다
LOCAL@SPRING_DUMMY:2 = 0
;D는, 만족도의 수치가 됩니다
LOCAL@SPRING_DUMMY:3 = 0
;E는, V, A경험이 있을까의 체크에 사용됩니다. &1그리고 A&2로 V&4로 처녀 상실
LOCAL@SPRING_DUMMY:4 = 0
;F는, 체력 다운의 기준치로서 사용됩니다.
LOCAL@SPRING_DUMMY:5 = 0
;G는, 온 손님이 수라고 해 사용됩니다.
LOCAL@SPRING_DUMMY:6 = 0



LOCAL@SPRING_NIN = 0

IF CFLAG:COUNT:1501 == 1
	PRINTFORML %CALLNAME:COUNT%의 매춘 결과：
	CALL SPRING_1ST
ELSEIF CFLAG:COUNT:1501 == 2
	PRINTFORML %CALLNAME:COUNT%의 매춘 결과：
	CALL SPRING_2ND
ELSEIF CFLAG:COUNT:1501 == 3
	PRINTFORML %CALLNAME:COUNT%의 매춘 결과：
	CALL SPRING_3RD
ELSEIF CFLAG:COUNT:1501 == 4
	PRINTFORML %CALLNAME:COUNT%의 매춘 결과：
	CALL SPRING_4TH
ELSEIF CFLAG:COUNT:1501 == 5
	PRINTFORML %CALLNAME:COUNT%의 매춘 결과：
	CALL SPRING_5TH
ELSEIF CFLAG:COUNT:1501 == 6
	PRINTFORML %CALLNAME:COUNT%의 매춘 결과：
	CALL SPRING_6TH
ELSEIF CFLAG:COUNT:1501 == 7
	IF LOCAL@SPRING_7TH:0 == -1
		LOCAL@SPRING_7TH:0 = COUNT
	ELSE
		LOCAL@SPRING_7TH:1 = COUNT
	ENDIF
	RETURN 0
ELSEIF CFLAG:COUNT:1501 == 8
	RETURN 0
ELSEIF CFLAG:COUNT:1501 == 9
	RETURN 0
ELSEIF CFLAG:COUNT:1501 == 10
	RETURN 0
ELSEIF CFLAG:COUNT:1501 == 11
	RETURN 0
ELSEIF CFLAG:COUNT:1501 == 12
	RETURN 0
ELSEIF CFLAG:COUNT:1501 == 13
	RETURN 0
ELSEIF CFLAG:COUNT:1501 == 14
	RETURN 0
ELSEIF CFLAG:COUNT:1501 == 15
	RETURN 0
ELSEIF CFLAG:COUNT:1501 == 16
	RETURN 0
ELSEIF CFLAG:COUNT:1501 == 17
	PRINTFORML %CALLNAME:COUNT%의 매춘 결과：
	Z = 2
	CALL SELF_KOJO, COUNT, 1700
ENDIF
DRAWLINE
SIF LOCAL@SPRING_NIN != 0
	CALL SPRING_NIN
CALL SPRING_EXP
CALL SPRING_MONEY
CALL SPRING_DOWN
CALL SPRING_BASE
WAIT
DRAWLINE



@SPRING_PERSON_A

;손님의 인원수를 결정합니다.
LOCAL@SPRING_DUMMY:0 = COUNT

;단골손님이 와 줍니다.
IF TALENT:(LOCAL@SPRING_DUMMY:0):265
	REPEAT TALENT:(LOCAL@SPRING_DUMMY:0):265
		LOCAL@SPRING_DUMMY:6 += RAND:2
	REND
ENDIF

IF EXP:(LOCAL@SPRING_DUMMY:0):76 == 0
	;매춘 데뷔시는, 인기가 없기 때문에 가게의 인기에 응한 값이 됩니다.
	LOCAL@SPRING_DUMMY:1 = FLAG:3005
	LOCAL@SPRING_DUMMY:1 /= 10
	IF LOCAL@SPRING_DUMMY:1
		REPEAT LOCAL@SPRING_DUMMY:1
			LOCAL@SPRING_DUMMY:6 += RAND:2
		REND
	ENDIF
ELSE
	;창녀의 인기에 응해 손님이 옵니다
	LOCAL@SPRING_DUMMY:1 = EXP:(LOCAL@SPRING_DUMMY:0):77
	LOCAL@SPRING_DUMMY:1 /= 10
	IF LOCAL@SPRING_DUMMY:1
		REPEAT LOCAL@SPRING_DUMMY:1
			LOCAL@SPRING_DUMMY:6 += RAND:2
		REND
	ENDIF
ENDIF
;가게에 인기에 응해 손님이 옵니다
LOCAL@SPRING_DUMMY:1 = FLAG:3005
LOCAL@SPRING_DUMMY:1 /= 20
IF LOCAL@SPRING_DUMMY:1
	REPEAT LOCAL@SPRING_DUMMY:1
		LOCAL@SPRING_DUMMY:6 += RAND:2
		SIF DAY:7 == 1
			LOCAL@SPRING_DUMMY:6 += RAND:2
	REND
ENDIF

COUNT = LOCAL@SPRING_DUMMY:0
SIF LOCAL@SPRING_DUMMY:6 < 2
	LOCAL@SPRING_DUMMY:6 = 2
SIF LOCAL@SPRING_DUMMY:6 > 20 && (FLAG:3000 & 8388608) == 0
	LOCAL@SPRING_DUMMY:6 = 20
;창녀의 인기로 최고 10명, 가게의 인기로 최고 5명. 거기에 단골손님을 대면시켜 최고 20명의 손님을 상대에게……됩니다.
;덧붙여 인기가 최고 레벨에서의, 평균치는 12,13명이 됩니다.
;단골손님이 대표의 손님인가 어떤가 조사합니다
IF TALENT:COUNT:265
	SIF RAND:(LOCAL@SPRING_DUMMY:6) < TALENT:COUNT:265
		LOCAL@SPRING_DUMMY:2 = 1
ENDIF

;계속되어, 만족도의 결정.
;D로 만족도 판정을 실시합니다

;랜덤으로 40을 추가합니다. 매춘 경험에 응해 기대치는 상승합니다.
IF EXP:COUNT:76 > 10000 && LOCAL@SPRING_DUMMY:2
	LOCAL@SPRING_DUMMY:3 = 40
ELSEIF (EXP:COUNT:76 > 5000 && LOCAL@SPRING_DUMMY:2) || EXP:COUNT:76 > 10000
	LOCAL@SPRING_DUMMY:3 = RAND:11 + 30
ELSEIF (EXP:COUNT:76 > 3000 && LOCAL@SPRING_DUMMY:2) || EXP:COUNT:76 > 5000
	LOCAL@SPRING_DUMMY:3 = RAND:16 + 25
ELSEIF (EXP:COUNT:76 > 1000 && LOCAL@SPRING_DUMMY:2) || EXP:COUNT:76 > 3000
	LOCAL@SPRING_DUMMY:3 = RAND:21 + 20
ELSEIF (EXP:COUNT:76 > 500 && LOCAL@SPRING_DUMMY:2) || EXP:COUNT:76 > 1000
	LOCAL@SPRING_DUMMY:3 = RAND:26 + 15
ELSEIF (EXP:COUNT:76 > 100 && LOCAL@SPRING_DUMMY:2) || EXP:COUNT:76 > 500
	LOCAL@SPRING_DUMMY:3 = RAND:31 + 10
ELSEIF (EXP:COUNT:76 > 50 && LOCAL@SPRING_DUMMY:2) || EXP:COUNT:76 > 100
	LOCAL@SPRING_DUMMY:3 = RAND:36 + 5
ELSE
	LOCAL@SPRING_DUMMY:3 = RAND:41
ENDIF
LOCAL@SPRING_DUMMY:4 = 0
;일정 확률로 비디오 촬영을 행합니다.
IF RAND:3 == 0 && FLAG:3000 & 4
	LOCAL@SPRING_DUMMY:4 |= 16
	LOCAL@SPRING_DUMMY:3 += 1
ENDIF

@SPRING_PERSON_B

LOCAL@SPRING_DUMMY:0 = COUNT
LOCAL@SPRING_DUMMY:1 = 0
;단골손님이 와 줍니다.
IF TALENT:(LOCAL@SPRING_DUMMY:0):265
REPEAT TALENT:(LOCAL@SPRING_DUMMY:0):265
	LOCAL@SPRING_DUMMY:6 += RAND:2
REND
ENDIF

SIF LOCAL@SPRING_DUMMY:6 > 0
	LOCAL@SPRING_DUMMY:2 = 1

;창녀의 인기에 응해 손님이 옵니다
LOCAL@SPRING_DUMMY:1 = EXP:(LOCAL@SPRING_DUMMY:0):77
LOCAL@SPRING_DUMMY:1 /= 4
IF LOCAL@SPRING_DUMMY:1
REPEAT LOCAL@SPRING_DUMMY:1
	LOCAL@SPRING_DUMMY:6 += RAND:2
REND
ENDIF
;가게에 인기에 응해 손님이 옵니다
LOCAL@SPRING_DUMMY:1 = FLAG:3005
LOCAL@SPRING_DUMMY:1 /= 5
IF LOCAL@SPRING_DUMMY:1
REPEAT LOCAL@SPRING_DUMMY:1
	LOCAL@SPRING_DUMMY:6 += RAND:2
	SIF DAY:7 == 1
		LOCAL@SPRING_DUMMY:6 += RAND:2
REND
ENDIF

COUNT = LOCAL@SPRING_DUMMY:0

SIF LOCAL@SPRING_DUMMY:6 < 3
	LOCAL@SPRING_DUMMY:6 = 3
SIF LOCAL@SPRING_DUMMY:6 > 50 && (FLAG:3000 & 8388608) == 0
	LOCAL@SPRING_DUMMY:6 = 50
;, 창녀의 인기로 최고 25명, 가게의 인기로 최고 20명. 거기에 단골손님을 대면시켜 최고 50명의 손님을 상대에게……됩니다.
;덧붙여 인기가 최고 레벨에서의, 평균치는 27, 28명이 됩니다.
;계속되어, 만족도의 결정.
;D로 만족도 판정을 실시합니다
;여기에서는, 만족도에 관한 공통의 처리를 행합니다.

;랜덤으로 50을 추가합니다. 매춘 경험에 응해 기대치는 상승합니다. 일대일때와 달라, 얼마나 경험이 있어도 랜덤성이 남습니다.
IF EXP:COUNT:76 > 10000 && LOCAL@SPRING_DUMMY:2
	LOCAL@SPRING_DUMMY:3 = RAND:10 + 40
ELSEIF (EXP:COUNT:76 > 5000 && LOCAL@SPRING_DUMMY:2) || EXP:COUNT:76 > 10000
	LOCAL@SPRING_DUMMY:3 = RAND:21 + 30
ELSEIF (EXP:COUNT:76 > 3000 && LOCAL@SPRING_DUMMY:2) || EXP:COUNT:76 > 5000
	LOCAL@SPRING_DUMMY:3 = RAND:26 + 25
ELSEIF (EXP:COUNT:76 > 1000 && LOCAL@SPRING_DUMMY:2) || EXP:COUNT:76 > 3000
	LOCAL@SPRING_DUMMY:3 = RAND:31 + 20
ELSEIF (EXP:COUNT:76 > 500 && LOCAL@SPRING_DUMMY:2) || EXP:COUNT:76 > 1000
	LOCAL@SPRING_DUMMY:3 = RAND:36 + 15
ELSEIF (EXP:COUNT:76 > 100 && LOCAL@SPRING_DUMMY:2) || EXP:COUNT:76 > 500
	LOCAL@SPRING_DUMMY:3 = RAND:41 + 10
ELSEIF (EXP:COUNT:76 > 50 && LOCAL@SPRING_DUMMY:2) || EXP:COUNT:76 > 100
	LOCAL@SPRING_DUMMY:3 = RAND:46 + 5
ELSE
	LOCAL@SPRING_DUMMY:3 = RAND:51
ENDIF
;일정 확률로 비디오 촬영을 행합니다.
LOCAL@SPRING_DUMMY:4 = 0
IF RAND:3 == 0 && FLAG:3000 & 4
	LOCAL@SPRING_DUMMY:4 |= 16
	LOCAL@SPRING_DUMMY:3 += 1
ENDIF

@SPRING_PERSON_C
LOCAL@SPRING_DUMMY:3 = FLAG:3005
LOCAL@SPRING_DUMMY:6 = 0
IF LOCAL@SPRING_DUMMY:3
REPEAT LOCAL@SPRING_DUMMY:3
	LOCAL@SPRING_DUMMY:6 += RAND:2
REND
ENDIF

@SPRING_PERSON_D
;단골손님이 와 줍니다.

LOCAL@SPRING_DUMMY:3 = COUNT
IF TALENT:(LOCAL@SPRING_DUMMY:3):265
REPEAT TALENT:(LOCAL@SPRING_DUMMY:3):265
	LOCAL@SPRING_DUMMY:6 += RAND:2
REND
ENDIF
COUNT = LOCAL@SPRING_DUMMY:3

@SPRING_HAPPY
;만족도에 응해, 결과가 나옵니다.
;일단 최고 80점만점. 계산방법은 각 매춘을 참고에 부디

;매춘 내용에 관계없는 보너스
;음란 소유는 2, 수수께끼의 매력 소유는 2, 창녀는 3포인트의 보너스입니다.

SIF TALENT:COUNT:170
	LOCAL@SPRING_DUMMY:3 += 2
SIF TALENT:COUNT:92
	LOCAL@SPRING_DUMMY:3 += 2
SIF TALENT:COUNT:260
	LOCAL@SPRING_DUMMY:3 += 3

IF LOCAL@SPRING_DUMMY:3 >= 90 && FLAG:3000 & 8388608
	LOCAL@SPRING_DUMMY:3 -= 70
	LOCAL@SPRING_DUMMY:3 /= 20
	LOCAL@SPRING_DUMMY:0 = LOCAL@SPRING_DUMMY:3 + 5
	SIF LOCAL@SPRING_DUMMY:0 >= 100
		LOCAL@SPRING_DUMMY:0 = 99

ELSEIF LOCAL@SPRING_DUMMY:3 > 74
;최고 평가입니다
	LOCAL@SPRING_DUMMY:0 = 5
ELSEIF LOCAL@SPRING_DUMMY:3 > 58
	LOCAL@SPRING_DUMMY:0 = 4
ELSEIF LOCAL@SPRING_DUMMY:3 > 46
;조금 괜찮은 평가입니다
	LOCAL@SPRING_DUMMY:0 = 3
ELSEIF LOCAL@SPRING_DUMMY:3 > 33
;보통 평가입니다
	LOCAL@SPRING_DUMMY:0 = 2
ELSEIF LOCAL@SPRING_DUMMY:3 > 20
;나쁜 평가입니다
	LOCAL@SPRING_DUMMY:0 = 1
ELSE
;최저 평가입니다
	LOCAL@SPRING_DUMMY:0 = 0
ENDIF


CALL SELF_KOJO, COUNT, TFLAG:200


IF LOCAL@SPRING_DUMMY:4 & 64
	TFLAG:200 = 1500
	CALL SELF_KOJO, COUNT, 1500
ENDIF
IF (LOCAL@SPRING_DUMMY:4 & 8 || LOCAL@SPRING_DUMMY:4 & 4) && TFLAG:200 != 1500
	CALL SELF_KOJO, COUNT, 1600
ENDIF

@SPRING_EXP

IF TALENT:COUNT:0 && LOCAL@SPRING_DUMMY:4 & 4
	PRINTL 【처녀 상실】
	LOCAL@SPRING_EXP:50 += 1
	TALENT:COUNT:0 = 0
	LOCAL@SPRING_DUMMY:5 += 10
ENDIF
IF TALENT:COUNT:140
	PRINTL 【임신】 중에 매춘이기 때문에 많은 수입을 추가로 얻었습니다.
	PRINTL 모체에 굉장한 부담이 걸렸습니다.
	LOCAL@SPRING_EXP:77 += 10
	;에 해 중 또한 처녀막 재생 상태로 매춘시킨다든가라고 하는 귀축이겠지요.
	;위의 처녀 상실의 분과 합해, F가 25 증가하기 위해(때문에), 촉수 난교의 2.5배라고 하는 심상하지 않은 부하가 추가됩니다. 정말로 언제 사라져도 이상하지 않다.
	IF LOCAL@SPRING_DUMMY:4 & 4
		LOCAL@SPRING_DUMMY:5 += 15
	ELSEIF LOCAL@SPRING_DUMMY:4 & 2
		LOCAL@SPRING_DUMMY:5 += 12
	ELSEIF LOCAL@SPRING_DUMMY:4 & 1
		LOCAL@SPRING_DUMMY:5 += 8
	ELSE
		LOCAL@SPRING_DUMMY:5 += 4
	ENDIF
ENDIF

IF EXP:COUNT:76 == 0
	SIF ((FLAG:3000 & 512) == 0 && ((FLAG:3000 & 16384) == 0) || (FLAG:3000 & 512 && (FLAG:3000 & 1048576) == 0))
		PRINTFORML 【%조사처리(CALLNAME:COUNT,"가")% 매춘 데뷔했습니다】
	LOCAL@SPRING_EXP:50 += 1
	LOCAL@SPRING_DUMMY:1 = LOCAL@SPRING_DUMMY:0
	LOCAL@SPRING_DUMMY:1 *= 10
	SIF LOCAL@SPRING_DUMMY:0 == 100
		LOCAL@SPRING_DUMMY:1 = 30
	;인기 보정
	SIF TALENT:COUNT:94 && LOCAL@SPRING_DUMMY:1 < 40
		LOCAL@SPRING_DUMMY:1 = 40
	;수수께끼의 매력, 매력 보정
	SIF TALENT:COUNT:92 || TALENT:COUNT:90
		LOCAL@SPRING_DUMMY:1 += 10
	IF LOCAL@SPRING_DUMMY:1 == 0
		SIF ((FLAG:3000 & 512) == 0 && ((FLAG:3000 & 16384) == 0) || (FLAG:3000 & 512 && (FLAG:3000 & 1048576) == 0))
			PRINTFORML  유감스럽게도 인기는 전혀 얻지 못했지만, 앞으로도 열심히 노력해보자.
	ELSE
		EXP:COUNT:77 = LOCAL@SPRING_DUMMY:1
		IF NO:COUNT == 37 || NO:COUNT == 38 || NO:COUNT == 39 || NO:COUNT == 42 || NO:COUNT == 43 || NO:COUNT == 44 || NO:COUNT == 100 || NO:COUNT == 119
			SIF ((FLAG:3000 & 512) == 0 && ((FLAG:3000 & 16384) == 0) || (FLAG:3000 & 512 && (FLAG:3000 & 1048576) == 0))
				PRINTFORML 현재의 신앙심 {EXP:COUNT:77}
		ELSE
			SIF ((FLAG:3000 & 512) == 0 && ((FLAG:3000 & 16384) == 0) || (FLAG:3000 & 512 && (FLAG:3000 & 1048576) == 0))
				PRINTFORML 현재의 인기 {EXP:COUNT:77}
		ENDIF
	ENDIF
	LOCAL@SPRING_EXP:77 += 10
	;데뷔시는, 받을 수 있는 돈에 일정한 플러스 보정이 걸립니다.
ELSEIF LOCAL@SPRING_DUMMY:0 == 100
ELSEIF LOCAL@SPRING_DUMMY:0 >= 6 && FLAG:3000 & 8388608
	LOCAL@SPRING_DUMMY:11 = COUNT
	LOCAL@SPRING_DUMMY:10 = 5
	REPEAT LOCAL@SPRING_DUMMY:10
		LOCAL@SPRING_DUMMY:10 += COUNT / 4
	REND
	COUNT = LOCAL@SPRING_DUMMY:11
	IF NO:COUNT == 37 || NO:COUNT == 38 || NO:COUNT == 39 || NO:COUNT == 42 || NO:COUNT == 43 || NO:COUNT == 44 || NO:COUNT == 100 || NO:COUNT == 119
		SIF ((FLAG:3000 & 512) == 0 && ((FLAG:3000 & 16384) == 0) || (FLAG:3000 & 512 && (FLAG:3000 & 1048576) == 0))
			PRINTFORML 신앙심 {EXP:COUNT:77} + {LOCAL@SPRING_DUMMY:10}
	ELSE
		SIF ((FLAG:3000 & 512) == 0 && ((FLAG:3000 & 16384) == 0) || (FLAG:3000 & 512 && (FLAG:3000 & 1048576) == 0))
			PRINTFORML 인기 {EXP:COUNT:77} + {LOCAL@SPRING_DUMMY:10}
	ENDIF
	EXP:COUNT:77 += LOCAL@SPRING_DUMMY:10
	LOCAL /= 2
	SIF ((FLAG:3000 & 512) == 0 && ((FLAG:3000 & 16384) == 0) || (FLAG:3000 & 512 && (FLAG:3000 & 1048576) == 0))
		PRINTFORML 창관인기 {FLAG:3005} + {LOCAL@SPRING_DUMMY:10}
	FLAG:3005 += LOCAL@SPRING_DUMMY:10
	IF TALENT:COUNT:265 < 100000 && (LOCAL@SPRING_DUMMY:2 == 0 || CFLAG:COUNT:1501 == 5 || CFLAG:COUNT:1501 == 6) && TALENT:COUNT:27 == 0
		PRINTFORML 손님 몇 명은 %조사처리(CALLNAME:COUNT,"를")% 매우 마음에 들어하는 듯하다.
		IF TALENT:COUNT:265 == 0
			PRINTFORM %조사처리(CALLNAME:COUNT,"는")% 
			PRINTS TALENTNAME:265
			PRINTL 을 얻었다.
		ENDIF
		LOCAL@SPRING_DUMMY:10 = RAND:(LOCAL@SPRING_DUMMY:0) + 1
		SIF LOCAL@SPRING_DUMMY:10 > LOCAL@SPRING_DUMMY:6
			LOCAL@SPRING_DUMMY:10 = LOCAL@SPRING_DUMMY:6
		TALENT:COUNT:265 += LOCAL@SPRING_DUMMY:10
		PRINTFORML 【단골손님】 인원수 현재 {TALENT:COUNT:265}명.
	ENDIF

ELSEIF LOCAL@SPRING_DUMMY:0 == 0
	IF NO:COUNT == 37 || NO:COUNT == 38 || NO:COUNT == 39 || NO:COUNT == 42 || NO:COUNT == 43 || NO:COUNT == 44 || NO:COUNT == 100 || NO:COUNT == 119
		SIF ((FLAG:3000 & 512) == 0 && ((FLAG:3000 & 16384) == 0) || (FLAG:3000 & 512 && (FLAG:3000 & 1048576) == 0))
		PRINTFORML 신앙심 {EXP:COUNT:77} - 10
	ELSE
		SIF ((FLAG:3000 & 512) == 0 && ((FLAG:3000 & 16384) == 0) || (FLAG:3000 & 512 && (FLAG:3000 & 1048576) == 0))
		PRINTFORML 인기 {EXP:COUNT:77} - 10
	ENDIF
	EXP:COUNT:77 -= 10
	SIF EXP:COUNT:77 <= 0
		EXP:COUNT:77 = 0
	SIF ((FLAG:3000 & 512) == 0 && ((FLAG:3000 & 16384) == 0) || (FLAG:3000 & 512 && (FLAG:3000 & 1048576) == 0))
	PRINTFORML 창관인기 {FLAG:3005} - 3
	FLAG:3005 -= 3
	SIF FLAG:3005 <= 0
		FLAG:3005 = 0
ELSEIF LOCAL@SPRING_DUMMY:0 == 1
	IF NO:COUNT == 37 || NO:COUNT == 38 || NO:COUNT == 39 || NO:COUNT == 42 || NO:COUNT == 43 || NO:COUNT == 44 || NO:COUNT == 100 || NO:COUNT == 119
	SIF ((FLAG:3000 & 512) == 0 && ((FLAG:3000 & 16384) == 0) || (FLAG:3000 & 512 && (FLAG:3000 & 1048576) == 0))
		PRINTFORML 신앙심 {EXP:COUNT:77} - 5
	ELSE
	SIF ((FLAG:3000 & 512) == 0 && ((FLAG:3000 & 16384) == 0) || (FLAG:3000 & 512 && (FLAG:3000 & 1048576) == 0))
		PRINTFORML 인기 {EXP:COUNT:77} - 5
	ENDIF
	EXP:COUNT:77 -= 5
	SIF EXP:COUNT:77 <= 0
		EXP:COUNT:77 = 0
	SIF ((FLAG:3000 & 512) == 0 && ((FLAG:3000 & 16384) == 0) || (FLAG:3000 & 512 && (FLAG:3000 & 1048576) == 0))
	PRINTFORML 창관인기 {FLAG:3005} - 1
	FLAG:3005 -= 1
	SIF FLAG:3005 <= 0
		FLAG:3005 = 0
ELSEIF LOCAL@SPRING_DUMMY:0 == 2
	IF NO:COUNT == 37 || NO:COUNT == 38 || NO:COUNT == 39 || NO:COUNT == 42 || NO:COUNT == 43 || NO:COUNT == 44 || NO:COUNT == 100 || NO:COUNT == 119
	SIF ((FLAG:3000 & 512) == 0 && ((FLAG:3000 & 16384) == 0) || (FLAG:3000 & 512 && (FLAG:3000 & 1048576) == 0))
		PRINTFORML 신앙심 {EXP:COUNT:77} + 1
	ELSE
	SIF ((FLAG:3000 & 512) == 0 && ((FLAG:3000 & 16384) == 0) || (FLAG:3000 & 512 && (FLAG:3000 & 1048576) == 0))
		PRINTFORML 인기 {EXP:COUNT:77} + 1
	ENDIF
	EXP:COUNT:77 += 1
	SIF EXP:COUNT:77 >= 100 && (FLAG:3000 & 8388608) == 0
		EXP:COUNT:77 = 100
ELSEIF LOCAL@SPRING_DUMMY:0 == 3
	IF NO:COUNT == 37 || NO:COUNT == 38 || NO:COUNT == 39 || NO:COUNT == 42 || NO:COUNT == 43 || NO:COUNT == 44 || NO:COUNT == 100 || NO:COUNT == 119
	SIF ((FLAG:3000 & 512) == 0 && ((FLAG:3000 & 16384) == 0) || (FLAG:3000 & 512 && (FLAG:3000 & 1048576) == 0))
		PRINTFORML 신앙심 {EXP:COUNT:77} + 3
	ELSE
	SIF ((FLAG:3000 & 512) == 0 && ((FLAG:3000 & 16384) == 0) || (FLAG:3000 & 512 && (FLAG:3000 & 1048576) == 0))
		PRINTFORML 인기 {EXP:COUNT:77} + 3
	ENDIF
	EXP:COUNT:77 += 3
	SIF EXP:COUNT:77 >= 100 && (FLAG:3000 & 8388608) == 0
		EXP:COUNT:77 = 100
		SIF ((FLAG:3000 & 512) == 0 && ((FLAG:3000 & 16384) == 0) || (FLAG:3000 & 512 && (FLAG:3000 & 1048576) == 0))
	PRINTFORML 창관인기 {FLAG:3005} + 1
	FLAG:3005 += 1
	SIF FLAG:3005 >= 100 && (FLAG:3000 & 8388608) == 0
		FLAG:3005 = 100
ELSEIF LOCAL@SPRING_DUMMY:0 == 4
	IF NO:COUNT == 37 || NO:COUNT == 38 || NO:COUNT == 39 || NO:COUNT == 42 || NO:COUNT == 43 || NO:COUNT == 44 || NO:COUNT == 100 || NO:COUNT == 119
	SIF ((FLAG:3000 & 512) == 0 && ((FLAG:3000 & 16384) == 0) || (FLAG:3000 & 512 && (FLAG:3000 & 1048576) == 0))
		PRINTFORML 신앙심 {EXP:COUNT:77} + 5
	ELSE
	SIF ((FLAG:3000 & 512) == 0 && ((FLAG:3000 & 16384) == 0) || (FLAG:3000 & 512 && (FLAG:3000 & 1048576) == 0))
		PRINTFORML 인기 {EXP:COUNT:77} + 5
	ENDIF
	EXP:COUNT:77 += 5
	SIF EXP:COUNT:77 >= 100 && (FLAG:3000 & 8388608) == 0
		EXP:COUNT:77 = 100
		SIF ((FLAG:3000 & 512) == 0 && ((FLAG:3000 & 16384) == 0) || (FLAG:3000 & 512 && (FLAG:3000 & 1048576) == 0))
	PRINTFORML 창관인기 {FLAG:3005} + 2
	FLAG:3005 += 2
	SIF FLAG:3005 >= 100 && (FLAG:3000 & 8388608) == 0
		FLAG:3005 = 100
ELSEIF LOCAL@SPRING_DUMMY:0 == 5
	IF NO:COUNT == 37 || NO:COUNT == 38 || NO:COUNT == 39 || NO:COUNT == 42 || NO:COUNT == 43 || NO:COUNT == 44 || NO:COUNT == 100 || NO:COUNT == 119
	SIF ((FLAG:3000 & 512) == 0 && ((FLAG:3000 & 16384) == 0) || (FLAG:3000 & 512 && (FLAG:3000 & 1048576) == 0))
		PRINTFORML 신앙심 {EXP:COUNT:77} + 8
	ELSE
	SIF ((FLAG:3000 & 512) == 0 && ((FLAG:3000 & 16384) == 0) || (FLAG:3000 & 512 && (FLAG:3000 & 1048576) == 0))
		PRINTFORML 인기 {EXP:COUNT:77} + 8
	ENDIF
	EXP:COUNT:77 += 8
	SIF EXP:COUNT:77 >= 100 && (FLAG:3000 & 8388608) == 0
		EXP:COUNT:77 = 100
		SIF ((FLAG:3000 & 512) == 0 && ((FLAG:3000 & 16384) == 0) || (FLAG:3000 & 512 && (FLAG:3000 & 1048576) == 0))
	PRINTFORML 창관인기 {FLAG:3005} + 3
	FLAG:3005 += 3
	SIF FLAG:3005 >= 100 && (FLAG:3000 & 8388608) == 0
		FLAG:3005 = 100
	IF TALENT:COUNT:265 < 10 && (LOCAL@SPRING_DUMMY:2 == 0 || CFLAG:COUNT:1501 == 5 || CFLAG:COUNT:1501 == 6) && TALENT:COUNT:27 == 0
		PRINTFORML 손님 중 한 명은 %조사처리(CALLNAME:COUNT,"가")% 매우 마음에 든 것 같다.
		IF TALENT:COUNT:265 == 0
			PRINTFORM %조사처리(CALLNAME:COUNT,"는")% 
			PRINTS TALENTNAME:265
			PRINTL 을 얻었다.
		ENDIF
		TALENT:COUNT:265 += 1
		PRINTFORML 【단골손님】 인원수 현재 {TALENT:COUNT:265}명.
	ENDIF
ENDIF

;인기, 인기 여성, 특수 플레이에의 길의 취득
IF EXP:COUNT:77 == 100 && TALENT:COUNT:264 == 0 && (FLAG:3000 & 8388608) == 0
	IF NO:COUNT == 37 || NO:COUNT == 38 || NO:COUNT == 39 || NO:COUNT == 42 || NO:COUNT == 43 || NO:COUNT == 44 || NO:COUNT == 100 || NO:COUNT == 119
		PRINTFORML %CALLNAME:COUNT%에 대한 신앙심이 최고조에 이르렀다.
	ELSE
		PRINTFORML %CALLNAME:COUNT%의 인기가 최고조에 이르렀다.
	ENDIF
	PRINTFORM %조사처리(CALLNAME:COUNT,"는")% 
	PRINTS TALENTNAME:264
	PRINTL 를 얻었다.
	TALENT:COUNT:264 = 1
ELSEIF EXP:COUNT:77 < 70 && TALENT:COUNT:264 == 1
	IF NO:COUNT == 37 || NO:COUNT == 38 || NO:COUNT == 39 || NO:COUNT == 42 || NO:COUNT == 43 || NO:COUNT == 44 || NO:COUNT == 100 || NO:COUNT == 119
		PRINTFORML %CALLNAME:COUNT%에 대한 신앙이 하락일로를 걷는 듯하다.
	ELSE
		PRINTFORML %CALLNAME:COUNT%의 인기가 하락일로를 걷는 듯하다.
	ENDIF
	PRINTFORM %조사처리(CALLNAME:COUNT,"는")% 
	PRINTS TALENTNAME:264
	PRINTL 를 잃었다.
	TALENT:COUNT:264 = 0
ENDIF
IF FLAG:3005 >= 100 && (FLAG:3000 & 16) == 0
	PRINTFORML 창관의 인기가 최고조에 달했다.
	PRINTFORML 이에 따라, %CALLNAME:MASTER%의 이름은 대부호나 귀족에게까지 널리 퍼졌다.
	PRINTFORML 일요일 밤의 파티 메뉴가 늘었습니다.
	FLAG:3000 |= 16
ENDIF


LOCAL@SPRING_DUMMY:1 = COUNT

REPEAT 100
	IF COUNT == 0
		IF TALENT:COUNT:120 == 0
			IF LOCAL@SPRING_EXP:COUNT && ((FLAG:3000 & 512) == 0 && ((FLAG:3000 & 16384) == 0) || (FLAG:3000 & 512 && (FLAG:3000 & 1048576) == 0))
				PRINTFORM %EXPNAME:COUNT%　{EXP:(LOCAL@SPRING_DUMMY:1):COUNT} + 
				PRINTVL LOCAL@SPRING_EXP:COUNT
			ENDIF
			EXP:(LOCAL@SPRING_DUMMY:1):COUNT += LOCAL@SPRING_EXP:COUNT
			SIF COUNT == 0
				CFLAG:(LOCAL@SPRING_DUMMY:1):11 |= 1
		ENDIF
	ELSEIF COUNT == 76
		IF ((FLAG:3000 & 512) == 0 && ((FLAG:3000 & 16384) == 0) || (FLAG:3000 & 512 && (FLAG:3000 & 1048576) == 0))
			PRINTFORM 매춘경험　{EXP:(LOCAL@SPRING_DUMMY:1):76} + 
			PRINTVL LOCAL@SPRING_DUMMY:6
		ENDIF
		EXP:(LOCAL@SPRING_DUMMY:1):COUNT += LOCAL@SPRING_DUMMY:6
	ELSEIF COUNT == 77
		CONTINUE
	ELSE
		IF LOCAL@SPRING_EXP:COUNT && ((FLAG:3000 & 512) == 0 && ((FLAG:3000 & 16384) == 0) || (FLAG:3000 & 512 && (FLAG:3000 & 1048576) == 0))
			PRINTFORM %EXPNAME:COUNT%　{EXP:(LOCAL@SPRING_DUMMY:1):COUNT} + 
			PRINTVL LOCAL@SPRING_EXP:COUNT
		ENDIF
		EXP:(LOCAL@SPRING_DUMMY:1):COUNT += LOCAL@SPRING_EXP:COUNT
		SIF COUNT == 1
			CFLAG:(LOCAL@SPRING_DUMMY:1):11 |= 2
	ENDIF
REND
COUNT = LOCAL@SPRING_DUMMY:1
IF LOCAL@SPRING_DUMMY:4 & 8
	SIF ((FLAG:3000 & 512) == 0 && ((FLAG:3000 & 16384) == 0) || (FLAG:3000 & 512 && (FLAG:3000 & 1048576) == 0))
		PRINTFORM 피강간 경험　{EXP:COUNT:81} + 1
	EXP:COUNT:81 += 1
ENDIF


;창녀, 구애 의존을 취득합니다.
;창녀의 조건：매춘 경험 100이상, 반발 각인 이루어, 굴복 각인 3 LV, 인기 40이상
IF EXP:COUNT:76 >= 100 && MARK:COUNT:9 == 0 && MARK:COUNT:2 == 3 && TALENT:COUNT:260 == 0 && EXP:COUNT:77 >= 40
	PRINTFORMW %CALLNAME:COUNT%의 매춘시 상태가 이상하다….
	PRINTFORML %조사처리(CALLNAME:COUNT,"는")% 매춘에 대해 보람을 느끼기 시작한 모양이다…….
	PRINTFORMW %조사처리(NAME:COUNT,"는")% 【창녀】를 얻었다.
	TALENT:COUNT:260 = 1
	CALL SELF_KOJO, COUNT, 1801
ENDIF
;구애 의존의 조건：매춘 경험 300이상, 반발 각인 이루어, 연모미취득, 인기 60이상
IF EXP:COUNT:76 >= 300 && MARK:COUNT:9 == 0 && TALENT:COUNT:150 == 0 && TALENT:COUNT:261 == 0 && EXP:COUNT:77 >= 60
	PRINTFORMW %CALLNAME:COUNT%의 매춘시 상태가 이상하다….
	PRINTFORML %조사처리(CALLNAME:COUNT,"는")% 창녀로서 사랑받는 쾌감에 의존하고 있는 듯하다…….
	PRINTFORMW %조사처리(NAME:COUNT,"는")% 【구애의존】을 얻었다.
	TALENT:COUNT:261 = 1
	CALL SELF_KOJO, COUNT, 1802
ENDIF
;매춘 중독의 조건：매춘 중독도 80이상, 인기 여성, 구애 의존 소지
IF CFLAG:COUNT:1502 >= 80 && TALENT:COUNT:261 == 1 && TALENT:COUNT:262 == 0 && TALENT:COUNT:264 == 1
	PRINTFORMW %CALLNAME:COUNT%의 매춘시 상태가 이상하다….
	PRINTFORML %조사처리(CALLNAME:COUNT,"는")% 창녀로서 사랑받지 못하면 몹시 불안해진 모양이다…….
	PRINTFORMW %조사처리(NAME:COUNT,"는")% 【매춘중독】에 빠졌다.
	TALENT:COUNT:262 = 1
	IF COUNT == MASTER
		PRINTFORMW %조사처리(CALLNAME:MASTER,"는")% 봄팔이 생활만 하고 싶어한다.
		PRINTFORMW 그래서, 조교사는 때려쳤다.
		PRINTFORMW SHOP 화면에서 조교 행위를 선택할 수 없게 되었습니다.
	ENDIF
ENDIF


@SPRING_MONEYD

;ITEMPRICE:XXX
LOCAL = ITEMPRICE:(100 + NO:COUNT)
;원의 가격이 10000보다 큰 사람은, 원가 120
IF LOCAL > 10000
	LOCAL@SPRING_DUMMY:1 = 120
;원의 가격이 5000이상의 사람은, 원가 115
ELSEIF LOCAL > 5000
	LOCAL@SPRING_DUMMY:1 = 115
;원의 가격이 2000~5000의 사람은, 원가 110
ELSEIF LOCAL > 2000
	LOCAL@SPRING_DUMMY:1 = 110
;원의 가격이 1000대의 사람은, 원가 105
ELSEIF LOCAL > 1000
	LOCAL@SPRING_DUMMY:1 = 105
;원의 가격이 1000~500의 사람은, 원가 100
ELSEIF LOCAL > 500
	LOCAL@SPRING_DUMMY:1 = 100
;원의 가격이 500의 사람은, 원가 95
ELSEIF LOCAL == 500
	LOCAL@SPRING_DUMMY:1 = 95
;원의 가격이 500 미만의 사람은, 원가 90
ELSE
	LOCAL@SPRING_DUMMY:1 = 90
ENDIF

;범용 캐릭터 및 오리 캐릭터는 값이 내린다
SIF NO:COUNT >= 150
	LOCAL@SPRING_DUMMY:1 -= 10

;소질 보정
CALL SPRING_TALENTCHECK
LOCAL@SPRING_DUMMY:1 *= LOCAL@SPRING_TALENTCHECK
LOCAL@SPRING_DUMMY:1 /= 10000

;엔드리스 모드가 아닌 경우는 플러스 보정
SIF FLAG:5 == 0
	TIMES LOCAL@SPRING_DUMMY:1 , 1.20
;난이도 보정
IF FLAG:3 == 1
	TIMES LOCAL@SPRING_DUMMY:1 , 0.50
ELSEIF FLAG:3 == 2
	TIMES LOCAL@SPRING_DUMMY:1 , 0.80
ELSEIF FLAG:3 == 3
	TIMES LOCAL@SPRING_DUMMY:1 , 1.00
ELSEIF FLAG:3 == 4
	TIMES LOCAL@SPRING_DUMMY:1 , 1.20
ELSEIF FLAG:3 == 5
	TIMES LOCAL@SPRING_DUMMY:1 , 1.50
ELSEIF FLAG:3 == 6
	TIMES LOCAL@SPRING_DUMMY:1 , 3.00
ELSEIF FLAG:3 == 7
	TIMES LOCAL@SPRING_DUMMY:1 , 6.50
ELSE
	RETURN 0
ENDIF
;예속 경험 개미등으로 매각액이 격감합니다. 매물이라는 것(일)
SIF TALENT:RESULT:161 || TALENT:RESULT:163 || TALENT:RESULT:167 || TALENT:RESULT:168 || TALENT:RESULT:169
	LOCAL@SPRING_DUMMY:1 /= 8

;마이너스가 되지 않게 캡 처리. 16 미만의 경우는 16에 끌어 올리기
SIF LOCAL@SPRING_DUMMY:1 < 16
	LOCAL@SPRING_DUMMY:1 = 16

;광기라면 10엔 할인!예속 경험 개미의 500엔 미만의 광기 소유의 사람은 2엔이 됩니다.
SIF TALENT:COUNT:158
	LOCAL@SPRING_DUMMY:1 -= 10

;일요일은 서비스 데이
SIF DAY:7 == 1
	LOCAL@SPRING_DUMMY:1 -= 5




@SPRING_G_CHECK
LOCAL@SPRING_DUMMY:7 = LOCAL@SPRING_DUMMY:6
LOCAL = 1
LOCAL:1 = 6
$G_CHECK
IF LOCAL@SPRING_DUMMY:6 > LOCAL:1
	LOCAL += 1
	LOCAL:1 += LOCAL * 3
	GOTO G_CHECK
ELSE
	LOCAL:1 -= LOCAL * 3
	LOCAL:2 = LOCAL * 3
	LOCAL@SPRING_DUMMY:6 = LOCAL:2 + ((LOCAL@SPRING_DUMMY:6 - LOCAL:1) / LOCAL)
ENDIF

@SPRING_MONEY
DRAWLINE
;계산식은 다음과 같이
;「그 사람의 원가」×「산 인원수 보정」×「플레이 내용 보정」×「만족도 보정」
IF CFLAG:COUNT:1501 == 5 || CFLAG:COUNT:1501 == 6
	SIF ((FLAG:3000 & 512) == 0 && (FLAG:3000 & 131072) == 0) || (FLAG:3000 & 512 && (FLAG:3000 & 1048576) == 0)
		PRINTFORML 오늘은 {LOCAL@SPRING_DUMMY:6}명을 한 번에 상대했습니다.
ELSE
	SIF ((FLAG:3000 & 512) == 0 && (FLAG:3000 & 131072) == 0) || (FLAG:3000 & 512 && (FLAG:3000 & 1048576) == 0)
		PRINTFORML 오늘은 {LOCAL@SPRING_DUMMY:6}명의 고객이 찾아왔습니다.
ENDIF
CALL SPRING_MONEYD

CALL SPRING_G_CHECK
LOCAL@SPRING_DUMMY:1 *= LOCAL@SPRING_DUMMY:6

;플레이 내용 보정
LOCAL@SPRING_DUMMY:1 *= LOCAL@SPRING_EXP:77

;인기 여성이라면 조금 증가한다.
SIF TALENT:COUNT:264
	TIMES LOCAL@SPRING_DUMMY:1 , 1.10

;만족도가 비싸면 가격도 증가합니다.
IF LOCAL@SPRING_DUMMY:0 == 0
	SIF ((FLAG:3000 & 512) == 0 && (FLAG:3000 & 131072) == 0) || (FLAG:3000 & 512 && (FLAG:3000 & 1048576) == 0)
		PRINTFORML 서비스가 너무 나빠 대량의 클레임이 걸려와, 일부 요금을 다시 돌려줘야만 하는 처지가 되었습니다.
	TIMES LOCAL@SPRING_DUMMY:1 , 0.50
ELSEIF LOCAL@SPRING_DUMMY:0 == 4
	TIMES LOCAL@SPRING_DUMMY:1 , 1.10
ELSEIF LOCAL@SPRING_DUMMY:0 == 5
	TIMES LOCAL@SPRING_DUMMY:1 , 1.20
ELSEIF LOCAL@SPRING_DUMMY:0 >= 6
	TIMES LOCAL@SPRING_DUMMY:1 , 1.30
ENDIF
SIF ((FLAG:3000 & 512) == 0 && (FLAG:3000 & 131072) == 0) || (FLAG:3000 & 512 && (FLAG:3000 & 1048576) == 0)
	PRINTFORML %조사처리(CALLNAME:COUNT,"는")% 그들에게서 매춘으로 {LOCAL@SPRING_DUMMY:1}원을 벌었습니다.
MONEY += LOCAL@SPRING_DUMMY:1
CALL SPRING_MONEY_CH
LOCAL@SPRING_DUMMY:1 /= LOCAL@SPRING_DUMMY:6
IF LOCAL@SPRING_DUMMY:4 & 4 && LOCAL@SPRING_DUMMY:4 & 8
	CALL SPRING_MONEYD
	LOCAL@SPRING_DUMMY:1 *= 250
	SIF ((FLAG:3000 & 512) == 0 && (FLAG:3000 & 131072) == 0) || (FLAG:3000 & 512 && (FLAG:3000 & 1048576) == 0)
		PRINTFORML 추가로, 처녀를 빼앗아버린 배상금으로 {LOCAL@SPRING_DUMMY:1}원을 얻었다.
	MONEY += LOCAL@SPRING_DUMMY:1
	CFLAG:COUNT:95 += LOCAL@SPRING_DUMMY:1
ELSEIF LOCAL@SPRING_DUMMY:4 & 8
	CALL SPRING_MONEYD
	LOCAL@SPRING_DUMMY:1 *= 50
	SIF ((FLAG:3000 & 512) == 0 && (FLAG:3000 & 131072) == 0) || (FLAG:3000 & 512 && (FLAG:3000 & 1048576) == 0)
		PRINTFORML 추가로, 규정외 서비스 대금으로 {LOCAL@SPRING_DUMMY:1}원을 얻었다.
	MONEY += LOCAL@SPRING_DUMMY:1
	CFLAG:COUNT:95 += LOCAL@SPRING_DUMMY:1
ELSEIF LOCAL@SPRING_DUMMY:4 & 4
	CALL SPRING_MONEYD
	LOCAL@SPRING_DUMMY:1 *= 150
	SIF ((FLAG:3000 & 512) == 0 && (FLAG:3000 & 131072) == 0) || (FLAG:3000 & 512 && (FLAG:3000 & 1048576) == 0)
		PRINTFORML 추가로, 처녀를 판 걸로 {LOCAL@SPRING_DUMMY:1}원을 얻었다.
	MONEY += LOCAL@SPRING_DUMMY:1
	CFLAG:COUNT:95 += LOCAL@SPRING_DUMMY:1
ENDIF
;손님에 의한 비디오의 수매 처리는 여기에 들어갑니다.
IF FLAG:3000 & 4 && LOCAL@SPRING_DUMMY:0 >= 3 && LOCAL@SPRING_DUMMY:4 & 16
	CALL SPRING_MONEYD
	LOCAL@SPRING_DUMMY:1 *= LOCAL@SPRING_EXP:77
	LOCAL@SPRING_DUMMY:1 *= 4
	SIF ((FLAG:3000 & 512) == 0 && (FLAG:3000 & 131072) == 0) || (FLAG:3000 & 512 && (FLAG:3000 & 1048576) == 0)
		PRINTFORML 덤으로, 매춘 내용을 비디오로 촬영한 물건이 {LOCAL@SPRING_DUMMY:1}원으로 팔렸습니다.
	MONEY += LOCAL@SPRING_DUMMY:1
	CFLAG:COUNT:95 += LOCAL@SPRING_DUMMY:1
ENDIF
LOCAL@SPRING_DUMMY:6 = LOCAL@SPRING_DUMMY:7

@SPRING_DOWN
;부정의 주를 얻습니다.
;순종이 높지 않으면 땅땅 모여 갑니다.
;순종이 높아도 모이는 것은 모입니다.
;인원수 인플레 하는 탓으로 무섭게 되었습니다. 살려

LOCAL@SPRING_DUMMY:0 = LOCAL@SPRING_DUMMY:6
LOCAL@SPRING_DUMMY:1 = 6 - ABL:COUNT:10
SIF ABL:COUNT:10 > 5
	LOCAL@SPRING_DUMMY:1 = 1
LOCAL@SPRING_DUMMY:0 *= 4
LOCAL@SPRING_DUMMY:0 *= LOCAL@SPRING_DUMMY:1
LOCAL@SPRING_DUMMY:0 *= LOCAL@SPRING_DUMMY:1

;대많은 사람 보정
SIF CFLAG:COUNT:1501 == 5 || CFLAG:COUNT:1501 == 6
	TIMES LOCAL@SPRING_DUMMY:0 , 1.25

;소질 보정
CALL SPRING_TALENTCHECK
LOCAL@SPRING_DUMMY:0 *= LOCAL@SPRING_TALENTCHECK
LOCAL@SPRING_DUMMY:0 /= 10000

;창녀라면 한층 더 적게 된다.
SIF TALENT:COUNT:260
	TIMES LOCAL@SPRING_DUMMY:0 , 0.80

;인기 여성이다 한층 더 돌아가신다.
SIF TALENT:COUNT:264
	TIMES LOCAL@SPRING_DUMMY:0 , 0.80

;봄의 사람이라면 굉장히 적게 된다.
SIF TALENT:COUNT:263
	TIMES LOCAL@SPRING_DUMMY:0 , 0.75

;연모 하고 있다고(면) 싫은 기분
SIF TALENT:COUNT:150
	TIMES LOCAL@SPRING_DUMMY:0 , 1.20

;서로 사랑함하고 있다고(면) 굉장히 싫은 기분
SIF TALENT:COUNT:153
	TIMES LOCAL@SPRING_DUMMY:0 , 2.50

;질투하고 있다고(면) 이것은 심하다
SIF TALENT:COUNT:157
	LOCAL@SPRING_DUMMY:0 *= 100

;E보정
;예정외의 성행위에 이르러지면(자) 증가한다
SIF LOCAL@SPRING_DUMMY:4 & 8
	TIMES LOCAL@SPRING_DUMMY:0 , 1.50

;처녀를 덮쳐 빼앗겼을 경우, 회전을 더해 3배
SIF LOCAL@SPRING_DUMMY:4 & 4 && TALENT:COUNT:260 == 0
	LOCAL@SPRING_DUMMY:0 *= 3

;창녀 상태로 처녀를 팔았을 경우, 그런데도 2배
SIF LOCAL@SPRING_DUMMY:4 & 4 && TALENT:COUNT:260
	LOCAL@SPRING_DUMMY:0 *= 2

;카메라 촬영시는 피사경효험이 적으면 증가한다
SIF LOCAL@SPRING_DUMMY:4 & 16 && EXP:COUNT:72 <= 100
	TIMES LOCAL@SPRING_DUMMY:0 , 1.25

;일까-이상한 매춘의 경우, 2.5배의 보정
SIF LOCAL@SPRING_DUMMY:4 & 32
	TIMES LOCAL@SPRING_DUMMY:0 , 2.50

;주회 플레이로 난이도 업. FLAG:7으로 계승한 인원수를 판정
IF CFLAG:COUNT:18 > 0
	TIMES LOCAL@SPRING_DUMMY:0 , 1.80
ELSEIF FLAG:7 > 0
	TIMES LOCAL@SPRING_DUMMY:0 , 1.50
ELSEIF FLAG:6 > 0
	TIMES LOCAL@SPRING_DUMMY:0 , 1.20
ENDIF

;엔드리스 모드가 아닌 경우는 마이너스 보정
SIF FLAG:5 == 0
	TIMES LOCAL@SPRING_DUMMY:0 , 0.80

;인플레 너무 하고 를 방지
SIF LOCAL@SPRING_DUMMY:0 > 100000
	LOCAL@SPRING_DUMMY:0 = 100000
;주인에게는 부정의 주는 발생하지 않지만, 대신에 체력 데미지로서 반영된다.
IF COUNT == MASTER
	IF TALENT:COUNT:262
		TIMES LOCAL@SPRING_DUMMY:0 , 0.50
	ELSEIF TALENT:COUNT:261
		TIMES LOCAL@SPRING_DUMMY:0 , 0.80
	ELSEIF TALENT:COUNT:260
		TIMES LOCAL@SPRING_DUMMY:0 , 1.50
	ELSEIF EXP:COUNT:76 >= 100
		TIMES LOCAL@SPRING_DUMMY:0 , 2.00
	ELSE
		TIMES LOCAL@SPRING_DUMMY:0 , 2.50
	ENDIF
	PRINTFORML ※주인은 부정의 구슬을 얻지 않는 대신에 체력을 소모합니다.
	PRINTFORML 체력 {BASE:COUNT:0}　-　{LOCAL@SPRING_DUMMY:0}
	BASE:COUNT:0 -= LOCAL@SPRING_DUMMY:0
;구애 의존이라고 「반전한다」
ELSEIF TALENT:COUNT:261
	LOCAL@SPRING_DUMMY:1 = LOCAL@SPRING_DUMMY:0
	TIMES LOCAL@SPRING_DUMMY:0 , 0.10
	IF ((FLAG:3000 & 512) == 0 && (FLAG:3000 & 65536) == 0) || (FLAG:3000 & 512 && (FLAG:3000 & 1048576) == 0)
		PRINTFORML 순종의 구슬 {JUEL:COUNT:12}　+　{LOCAL@SPRING_DUMMY:0}
	ENDIF
	JUEL:COUNT:12 += LOCAL@SPRING_DUMMY:0
	LOCAL@SPRING_DUMMY:0 = LOCAL@SPRING_DUMMY:1
ELSE
	IF ((FLAG:3000 & 512) == 0 && (FLAG:3000 & 65536) == 0) || (FLAG:3000 & 512 && (FLAG:3000 & 1048576) == 0)
		PRINTFORML 부정의 구슬 {JUEL:COUNT:100}　+　{LOCAL@SPRING_DUMMY:0}
	ENDIF
	JUEL:COUNT:100 += LOCAL@SPRING_DUMMY:0
ENDIF

;부정의 주의 허용량을 결정합니다.
;순종의 100배＋100까지 허용 할 수 있습니다. LV2는 루트 2배, LV3는 루트 3배
;난이도 H이상이라면+100이 사라집니다
LOCAL@SPRING_DUMMY:3 = ABL:COUNT:10
SIF LOCAL@SPRING_DUMMY:3 > 5 && (FLAG:3000 & 8388608) == 0
	LOCAL@SPRING_DUMMY:3 = 5
LOCAL@SPRING_DUMMY:3 *= 100
SIF FLAG:3 < 3
	LOCAL@SPRING_DUMMY:3 += 100
LOCAL@SPRING_DUMMY:1 = LOCAL@SPRING_DUMMY:3
TIMES LOCAL@SPRING_DUMMY:1 , 1.41
LOCAL@SPRING_DUMMY:2 = LOCAL@SPRING_DUMMY:3
TIMES LOCAL@SPRING_DUMMY:2 , 1.73

;반발 각인 이력은 남기지 않습니다. 몇 번이라도 괴로워하지만 좋다. 파파파
IF JUEL:COUNT:100 > LOCAL@SPRING_DUMMY:2
	PRINTL 반발각인 LV3을 취득.
	PRINTFORML %조사처리(CALLNAME:COUNT,"는")% 이 이상 매춘을 계속할 수 없습니다.
	MARK:COUNT:9 = 3
	CFLAG:COUNT:1501 = 0
	CFLAG:COUNT:4 -= 1024
	FLAG:3001 -= 1
	TFLAG:200 = 1800
	CALL SELF_KOJO, COUNT
ELSEIF JUEL:COUNT:100 > LOCAL@SPRING_DUMMY:1
	PRINTL 반발각인 LV2를 취득.
	PRINTFORML %조사처리(CALLNAME:COUNT,"는")% 이 이상 매춘을 계속할 수 없습니다.
	MARK:COUNT:9 = 2
	CFLAG:COUNT:1501 = 0
	CFLAG:COUNT:4 -= 1024
	FLAG:3001 -= 1
	TFLAG:200 = 1800
	CALL SELF_KOJO, COUNT
ELSEIF JUEL:COUNT:100 > LOCAL@SPRING_DUMMY:3
	PRINTL 반발각인 LV1을 취득.
	PRINTFORML %조사처리(CALLNAME:COUNT,"는")% 이 이상 매춘을 계속할 수 없습니다.
	CFLAG:COUNT:1501 = 0
	CFLAG:COUNT:4 -= 1024
	FLAG:3001 -= 1
	MARK:COUNT:9 = 1
	TFLAG:200 = 1800
	CALL SELF_KOJO, COUNT
ENDIF

@SPRING_DOWNCHECK
LOCAL = T:99
IF EXP:LOCAL:76 && FLAG:3000 & 2048 && MARK:LOCAL:9
	PRINTFORM 반발:{MARK:LOCAL:9}.
ELSE
	LOCAL@SPRING_DUMMY:3 = ABL:LOCAL:10
	SIF LOCAL@SPRING_DUMMY:3 > 5 && (FLAG:3000 & 8388608) == 0
		LOCAL@SPRING_DUMMY:3 = 5
	LOCAL@SPRING_DUMMY:3 *= 100
	SIF FLAG:3 < 3
		LOCAL@SPRING_DUMMY:3 += 100
	LOCAL@SPRING_DUMMY:3 -= JUEL:LOCAL:100
	PRINTFORM 부정:앞으로{LOCAL@SPRING_DUMMY:3}.
ENDIF

@SPRING_BASE
;촉수 난교시의 F가 10, 손님의 최고 보정치가 50이므로, 통상은 체력 소비 최대치는 500입니다.
;그 때문에, 체력 500 이하의 캐릭터를 매춘시키지 않게 하는 일로 미연에 사망을 막을 수 있습니다.
;그러나, 처녀등의 예외로 F가 증가하면(자), 사고사가 발생합니다.
;가장 심한 예로서에 해 중에 처녀막 재생한 상태로 촉수 난교로 손님 50명을 상대로 하면(자) F가 35, A가 50이므로, 체력 1750 소비가 됩니다.
;이것이 현재의 이론상 최대치입니다. ……임산부씨는 소중하게 취급합시다.
;덧붙여서, 반대로 최저 데미지는 50 정도.

;인원수에 응해, 데미지의 기준치를 결정합니다.
IF LOCAL@SPRING_DUMMY:6 > 70 && LOCAL@SPRING_DUMMY:5 <= 10
	LOCAL@SPRING_DUMMY:0 = 500
	LOCAL@SPRING_DUMMY:0 /= LOCAL@SPRING_DUMMY:5
ELSE
	IF LOCAL@SPRING_DUMMY:6 > 45
		LOCAL@SPRING_DUMMY:0 = 50
	ELSEIF LOCAL@SPRING_DUMMY:6 > 34
		LOCAL@SPRING_DUMMY:0 = 45
	ELSEIF LOCAL@SPRING_DUMMY:6 > 24
		LOCAL@SPRING_DUMMY:0 = 40
	ELSEIF LOCAL@SPRING_DUMMY:6 > 15
		LOCAL@SPRING_DUMMY:0 = 35
	ELSEIF LOCAL@SPRING_DUMMY:6 > 7
		LOCAL@SPRING_DUMMY:0 = 30
	ELSE
		LOCAL@SPRING_DUMMY:0 = 25
	ENDIF
	
	;소질 보정. 영향은 적은
	CALL SPRING_TALENTCHECK
	LOCAL@SPRING_DUMMY:0 *= ((LOCAL@SPRING_TALENTCHECK - 10000) / 2) + 10000
	LOCAL@SPRING_DUMMY:0 /= 10000
	SIF LOCAL@SPRING_DUMMY:6 < 70 && LOCAL@SPRING_DUMMY:0 > 50
		LOCAL@SPRING_DUMMY:0 = 50
ENDIF
LOCAL@SPRING_DUMMY:0 *= LOCAL@SPRING_DUMMY:5
SIF ((FLAG:3000 & 512) == 0 && (FLAG:3000 & 32768) == 0) || (FLAG:3000 & 512 && (FLAG:3000 & 1048576) == 0)
	PRINTFORML 체력 {BASE:COUNT:0}　-　{LOCAL@SPRING_DUMMY:0}
BASE:COUNT:0 -= LOCAL@SPRING_DUMMY:0

IF BASE:COUNT:0 <= 0 && FLAG:3000 & 16777216
	PRINTFORMSW STR:10
	PRINTFORMSW STR:11
	PRINTFORMSW STR:12
	PRINTFORMW ☆☆☆%조사처리(CALLNAME:COUNT,"는")% 사라졌습니다☆☆☆
	CLEARLINE 1
	PRINTW !
	PRINTL ·········
	PRINTL ·········
	PRINTL ·········
	PRINTL ·········
	PRINTL ·········
	PRINTL ·········
	PRINTW ·········
	PRINTFORML %조사처리(CALLNAME:COUNT,"는")% 의료팀 덕분에 일단 목숨을 건졌습니다.
	LOCAL@SPRING_DUMMY:0 = 0 - BASE:COUNT:0
	LOCAL@SPRING_DUMMY:0 *= 10000
	SIF LOCAL@SPRING_DUMMY:0 > MONEY
		LOCAL@SPRING_DUMMY:0 = MONEY
	PRINTFORMW 치료비로 {LOCAL@SPRING_DUMMY:0}원을 잃었습니다.
	MONEY -= LOCAL@SPRING_DUMMY:0
	BASE:COUNT:0 = 1
	MARK:COUNT:9 = 3
	SIF ABL:COUNT:10
		ABL:COUNT:10 -= 1
	IF CFLAG:COUNT:1501
		CFLAG:COUNT:1501 = 0
		CFLAG:COUNT:4 -= 1024
		FLAG:3001 -= 1
	ENDIF
ELSEIF BASE:COUNT:0 <= 0 && COUNT == MASTER
	PRINTFORMSW STR:10
	PRINTFORMSW STR:11
	PRINTFORMSW STR:12
	PRINTFORMW ☆☆☆%조사처리(CALLNAME:COUNT,"는")% 사라졌습니다☆☆☆
	CLEARLINE 1
	PRINTW !
	PRINTL ·········
	PRINTL ·········
	PRINTL ·········
	PRINTL ·········
	PRINTL ·········
	PRINTL ·········
	PRINTW ·········

	PRINTFORMW %CALLNAME:COUNT% 건은 비밀리에 처리되고 그녀의 몸은 호사가들에게 팔려버렸습니다.
	PRINTFORMW 그 후 %조사처리(CALLNAME:COUNT,"를")% 본 사람은 아무도 없었다고 합니다.
	DRAWLINE
	DRAWLINE
	PRINTFORMW 게임을 종료합니다.
	QUIT
	
ELSEIF BASE:COUNT:0 <= 0
	PRINTFORMSW STR:10
	PRINTFORMSW STR:11
	PRINTFORMSW STR:12
	PRINTFORMW ☆☆☆%조사처리(CALLNAME:COUNT,"는")% 사라졌습니다☆☆☆
	CLEARLINE 1
	PRINTW !
	PRINTL ·········
	PRINTL ·········
	PRINTL ·········
	PRINTL ·········
	PRINTL ·········
	PRINTL ·········
	PRINTW ·········

	PRINTFORMW %CALLNAME:COUNT% 건은 비밀리에 처리되고 그녀의 몸은 호사가들에게 팔려버렸습니다.
	PRINTFORMW 1000원을 얻었습니다.
	MONEY += 1000
	
ELSEIF BASE:COUNT:0 <= 500
	PRINTFORML 체력에 한계가 왔습니다. %조사처리(CALLNAME:COUNT,"가")% 매춘 멤버에서 빠집니다.
	IF CFLAG:COUNT:1501
		CFLAG:COUNT:1501 = 0
		CFLAG:COUNT:4 -= 1024
		FLAG:3001 -= 1
	ENDIF
	DRAWLINE
ENDIF

@SPRING_TALENTCHECK
;여기에서는, 소질에 의한 부정의 주, 체력, 수입의 증가 감소를 계산합니다
;수입이 증가하는 것과 동시에 부정의 주가 증가하므로, 소질의 선택이 어렵다……
LOCAL = 10000

;반항적이라고 증가한다
SIF TALENT:COUNT:11
	TIMES LOCAL , 1.20

;프라이드가 높으면 증가한다
SIF TALENT:COUNT:16
	TIMES LOCAL , 1.50

;무관심하다면 적게 된다.
SIF TALENT:COUNT:21
	TIMES LOCAL , 0.90

;감정 부족하면 적게 된다.
SIF TALENT:COUNT:22
	TIMES LOCAL , 0.90

;보수적이라고 증가한다
SIF TALENT:COUNT:24
	TIMES LOCAL , 1.20

;정조 관념이라고 증가한다
SIF TALENT:COUNT:30
	TIMES LOCAL , 1.80

;억압이라고 증가한다
SIF TALENT:COUNT:32
	TIMES LOCAL , 1.50

;(은)는 지뢰라고 증가한다
SIF TALENT:COUNT:35
	TIMES LOCAL , 1.20



@SPRING_OVERDOSE
;오프시는 무효
IF (FLAG:13 & 1024) == 0 || FLAG:3000 & 33554432
	RETURN 0
ENDIF

REPEAT 100
	R:COUNT = 0
REND
LOCAL = 0

REPEAT CHARANUM
	;육아중이라든지는 스르
	SIF CFLAG:COUNT:4 == 2
		CONTINUE

	IF CFLAG:COUNT:1501 == 5 || CFLAG:COUNT:1501 == 6
		CFLAG:COUNT:1502 += 2
		SIF TALENT:COUNT:262 == 1
			CFLAG:COUNT:1502 += 1
		;중독 충족
		SIF CFLAG:COUNT:1502 >= 100000
			CFLAG:COUNT:1502 -= 100000
	ELSEIF CFLAG:COUNT:1501
		CFLAG:COUNT:1502 += 1
		SIF TALENT:COUNT:262 == 1
			CFLAG:COUNT:1502 += 1
		;중독 충족
		SIF CFLAG:COUNT:1502 >= 100000
			CFLAG:COUNT:1502 -= 100000
	ELSE
		IF (MARK:COUNT:9 || BASE:COUNT:0 < 500) && TALENT:COUNT:262
			;중독증상입니다. 반감을 얻고 있다, 또는 체력 500 미만 상태에서는 굉장할 기세로 포인트가 쌓입니다
			CFLAG:COUNT:1502 += 100000
		ELSEIF MARK:COUNT:9 == 0 && BASE:COUNT:0 >= 500
			CFLAG:COUNT:1502 -= 2
			;중독증상의 개선
			SIF CFLAG:COUNT:1502 >= 100000
				CFLAG:COUNT:1502 -= 100000
		ENDIF
		SIF CFLAG:COUNT:1502 < 0
			CFLAG:COUNT:1502 = 0
	ENDIF
	IF CFLAG:COUNT:1502 == 0 && TALENT:COUNT:262 == 1
		PRINTFORML %조사처리(CALLNAME:COUNT,"는")% 창관이 없는 생활에 겨우 익숙해진 모양이다.
		PRINTFORMW %조사처리(CALLNAME:COUNT,"는")% 【매춘중독】을 잃었다…….
		TALENT:COUNT:262 = 0
	ELSEIF CFLAG:COUNT:1502 > 1400000 && TALENT:COUNT:262 == 1
;		IF RAND:3 == 0 && TALENT:COUNT:158 == 0
;			PRINTFORMW %CALLNAME:COUNT%의 모습이 이상하다…
;			PRINTFORML %조사처리(CALLNAME:COUNT,"는")%  창녀로서도, 노예로서도 사랑받지 않는 것에 다 참아 수 있지 않고, 망가져 버렸다……
;			PRINTFORMW %NAME:COUNT%는【광기】를 얻었다
;			TALENT:COUNT:158 = 1
;			CFLAG:COUNT:1502 -= 600000
;		ELSEIF RAND:3 == 0 && TALENT:COUNT:158 && TALENT:COUNT:169 == 0
;			PRINTFORMW %CALLNAME:COUNT%의 모습이 이상하다…
;			PRINTFORML %조사처리(CALLNAME:COUNT,"는")%  누구로부터도 사랑받지 않은 것에 다 참아 수 있지 않고, 완전하게 망가져 버렸다……
;			PRINTFORMW %NAME:COUNT%는【정신 붕괴】를 얻었다
;			TALENT:COUNT:169 = 1
;			CFLAG:COUNT:1502 -= 600000
;		ELSEIF RAND:2 == 0 && TALENT:COUNT:157 == 0
;			PRINTFORMW %CALLNAME:COUNT%의 모습이 이상하다…
;			PRINTFORML %조사처리(CALLNAME:COUNT,"는")%  창관에서 일하고 있는 사람들에게로의 격렬한 질투심을 안고 있는 것 같다……
;			PRINTFORMW %NAME:COUNT%는【질투】를 얻었다
;			TALENT:COUNT:157 = 1
;			CFLAG:COUNT:1502 -= 600000
;		ELSEIF RAND:2 == 0 && TALENT:COUNT:158 && TALENT:COUNT:157 && TALENT:COUNT:169
;			PRINTFORMW %CALLNAME:COUNT%의 모습이 눈에 띄지 않는다…
;			PRINTFORMW %조사처리(CALLNAME:MASTER,"가")% 얼마나%CALLNAME:COUNT%를 찾아도,%조사처리(CALLNAME:COUNT,"는")%  발견되지 않았다……
;			PRINTFORMW 후일, 마을에서 누 상관하지 않고 봄을 파는 색이상의 소녀의 소문이 났다.
;			PRINTFORMW 그 모습은,%CALLNAME:COUNT%에 자주(잘) 비슷한 것 같다……
;			R:LOCAL = COUNT
;			LOCAL += 1
;			IF COUNT == MASTER
;				PRINTFORMW 수정 불가능한 배드 엔드입니다. 게임을 종료합니다.
;				QUIT
;			ENDIF
;		ELSE
			PRINTFORMW %CALLNAME:COUNT%의 상태가 이상하다….
			PRINTFORML %조사처리(CALLNAME:COUNT,"는")% 창녀로서도, 노예로서도 사랑받지 못하는 현실을 견디지 못하는 모양이다…….
			PRINTFORMW %조사처리(NAME:COUNT,"는")% 대량의 부정의 구슬을 얻었다.
			JUEL:COUNT:100 += 10000
			CFLAG:COUNT:1502 -= 600000
;		ENDIF
	ELSEIF CFLAG:COUNT:1501 == 0 && TALENT:COUNT:262 == 1 && ITEM:90 > FLAG:3001 && MARK:COUNT:9 == 0 && CFLAG:COUNT:4 == 0 && CFLAG:COUNT:1502 > 160
		PRINTFORML %조사처리(CALLNAME:COUNT,"는")% 여러 사람들에게 사랑받는 쾌감을 잊지 못하는 모양이다다.
		PRINTFORM 문득 정신을 차리니 %조사처리(CALLNAME:COUNT,"는")% 
		SIF  BASE:COUNT:0 < 500
			PRINT 제 몸 상태를 돌아볼 생각도 안 한 채, 
		PRINTFORMW 멋대로 창관으로 발걸음을 옮기고 있었다…….
		SIF TARGET == COUNT
			TARGET = -1
		SIF ASSI == COUNT
			ASSI = -1
		CFLAG:COUNT:1501 = 1
		CFLAG:COUNT:1502 += 3
		FLAG:3001 += 1
		CFLAG:COUNT:4 |= 1024
	ELSEIF CFLAG:COUNT:1501 == 0 && TALENT:COUNT:262 == 1 && ITEM:90 > FLAG:3001 && MARK:COUNT:9 == 0 && BASE:COUNT:0 >= 500 && CFLAG:COUNT:4 == 0
		PRINTFORML %조사처리(CALLNAME:COUNT,"는")% 여러 사람들에게 사랑받는 쾌감을 잊지 못하는 모양이다.
		PRINTFORMW 문득 정신을 차리니 %조사처리(CALLNAME:COUNT,"는")% 멋대로 창관으로 발걸음을 옮기고 있었다…….
		SIF TARGET == COUNT
			TARGET = -1
		SIF ASSI == COUNT
			ASSI = -1
		CFLAG:COUNT:1501 = 1
		CFLAG:COUNT:1502 += 3
		FLAG:3001 += 1
		CFLAG:COUNT:4 |= 1024
	ENDIF
REND

;$BYE
;IF LOCAL
;	LOCAL -= 1
;	A = R:LOCAL
;	CALL SET_AFTERWARDS
;	DELCHARA A
;	GOTO BYE
;ENDIF

@SPRING_MONEY_CH
;--------------------------------------------------
;창관에서 번 최고 금액 판정 처리
M:777 = LOCAL@SPRING_DUMMY:1
IF M:777 > MONEY:800
	MONEY:800 = M:777
		SIF M:777 > MONEY:998
		MONEY:998 = M:777
ENDIF
IF M:777 > CFLAG:COUNT:80
	CFLAG:COUNT:80 = M:777
	SIF M:777 > CFLAG:COUNT:94
		CFLAG:COUNT:94 = M:777
ENDIF
CFLAG:COUNT:95 += M:777
;--------------------------------------------------
@SPRING_MONEY_CH2
;--------------------------------------------------
;창관에서 번 최고 금액 판정 처리
M:777 = LOCAL@SPRING_DUMMY:1
IF M:777 > MONEY:801
	MONEY:801 = M:777
		SIF M:777 > MONEY:998
		MONEY:998 = M:777
ENDIF
;--------------------------------------------------

@SPRING_MONEY_CH3
;--------------------------------------------------
M:777 = LOCAL@SPRING_DUMMY:1

COUNT = LOCAL@SPRING_7TH:0
IF M:777 > CFLAG:COUNT:81
	CFLAG:COUNT:81 = M:777
	SIF M:777 > CFLAG:COUNT:94
		CFLAG:COUNT:94 = M:777
ENDIF
CFLAG:COUNT:95 += M:777

COUNT = LOCAL@SPRING_7TH:1

IF M:777 > CFLAG:COUNT:81
	CFLAG:COUNT:81 = M:777
	SIF M:777 > CFLAG:COUNT:94
		CFLAG:COUNT:94 = M:777
ENDIF
CFLAG:COUNT:95 += M:777

@SPRING_MONEY_CH4
;--------------------------------------------------
COUNT = LOCAL@SPRING_7TH:0
CFLAG:COUNT:95 += LOCAL@SPRING_DUMMY:1
COUNT = LOCAL@SPRING_7TH:1
CFLAG:COUNT:95 += LOCAL@SPRING_DUMMY:1

@SPRING_MONEY_CH5
;--------------------------------------------------
REPEAT CHARANUM
	SIF CFLAG:COUNT:1501 == 8
		CFLAG:COUNT:95 += B
REND


@SPRING_RANKING
;FLAG:3010이 자신의 랭크. 외가, 다른 상점포의 인기 숫자가 됩니다.
IF FLAG:3011 == 0
	PRINTW 현재, 정보가 모여 있지 않습니다.
	RETURN 0
ENDIF
LOCAL@SPRING_DUMMY:0 = 3011
LOCAL = 1
LOCAL:1 = 1
$RANK
IF LOCAL == 11
ELSEIF FLAG:3005 >= FLAG:(LOCAL@SPRING_DUMMY:0) && LOCAL:1
	PRINTFORM 제{LOCAL}위　%NAME:MASTER% 창관
	STRLENS NAME:MASTER
	LOCAL@SPRING_DUMMY:1 = 20- RESULT
	SIF LOCAL == 10
		LOCAL@SPRING_DUMMY:1 -= 1
	IF LOCAL@SPRING_DUMMY:1 > 0
		REPEAT LOCAL@SPRING_DUMMY:1
			PRINT  
		REND
	ENDIF
	PRINTFORML  인기：{FLAG:3005}
	LOCAL += 1
	LOCAL:1 = 0
	GOTO RANK
ELSE
	PRINTFORM 제{LOCAL}위　%STR:(LOCAL@SPRING_DUMMY:0)%
	STRLENS STR:A
	LOCAL@SPRING_DUMMY:1 = 24- RESULT
	SIF LOCAL == 10
		LOCAL@SPRING_DUMMY:1 -= 1
	IF LOCAL@SPRING_DUMMY:1 > 0
		REPEAT LOCAL@SPRING_DUMMY:1
			PRINT  
		REND
	ENDIF
	PRINTFORML  인기：{FLAG:(LOCAL@SPRING_DUMMY:0)}
	LOCAL += 1
	LOCAL@SPRING_DUMMY:0 += 1
	GOTO RANK
ENDIF
PRINTW 이것이 현재의 랭킹입니다

@SPRING_RANKING_GROW
SIF (FLAG:3000 & 8388608) == 0
	RETURN 0
IF FLAG:3011 == 0
	FLAG:3011 = 800000
	FLAG:3012 = 193191
	FLAG:3013 = 65000
	FLAG:3014 = 24000
	FLAG:3015 = 5580
	FLAG:3016 = 2310
	FLAG:3017 = 560
	FLAG:3018 = 320
	FLAG:3019 = 70
ENDIF
REPEAT 9
	LOCAL@SPRING_DUMMY:0 = 3009 + COUNT
	LOCAL@SPRING_DUMMY:1 = 3010 + COUNT
	LOCAL@SPRING_DUMMY:2 = 3011 + COUNT
	FLAG:(LOCAL@SPRING_DUMMY:1) += RAND:20 - 6
	IF FLAG:(LOCAL@SPRING_DUMMY:0) < FLAG:(LOCAL@SPRING_DUMMY:1) && LOCAL@SPRING_DUMMY:1 != 3011
		LOCAL@SPRING_DUMMY:3 = FLAG:(LOCAL@SPRING_DUMMY:0)
		FLAG:(LOCAL@SPRING_DUMMY:0) = FLAG:(LOCAL@SPRING_DUMMY:1)
		FLAG:(LOCAL@SPRING_DUMMY:1) = LOCAL@SPRING_DUMMY:3
	ELSEIF FLAG:(LOCAL@SPRING_DUMMY:1) < FLAG:(LOCAL@SPRING_DUMMY:2) && LOCAL@SPRING_DUMMY:1 != 3019
		LOCAL@SPRING_DUMMY:3 = FLAG:(LOCAL@SPRING_DUMMY:1)
		FLAG:(LOCAL@SPRING_DUMMY:1) = FLAG:(LOCAL@SPRING_DUMMY:2)
		FLAG:(LOCAL@SPRING_DUMMY:2) = LOCAL@SPRING_DUMMY:3
	ENDIF
REND



@SPRING_NIN
;통상의 6 매춘에서는 임신의 위험성이 있습니다.
;세트 매춘, 이벤트 매춘에서는 처리가 난해하게 너무 되기 위해서(때문에) 스르 합니다

;콘피그에서는 축
SIF (FLAG:3000 & 134217728) == 0
	RETURN 0
;임신중도 튕긴다
SIF TALENT:COUNT:140
	RETURN 0
;남자도 튕긴다
SIF TALENT:COUNT:120
	RETURN 0
;주인도 튕긴다
SIF COUNT == MASTER
	RETURN 0
;확률에서는 축. 실로 2%. 그렇지만, 충분히 높다
SIF RAND:50
	RETURN 0

LOCAL@SPRING_EXP:50 += 1
LOCAL:3 = BASE:COUNT:0

;임신 처리는 TARGET나 ASSI 고정 이벤트가 많기 때문에 변경한다
LOCAL:1 = TARGET
TARGET = COUNT

;주인과의 아이를 임신한 처리. 현재, 과시하고 플레이만
IF LOCAL == 2

	PRINTFORML %CALLNAME:TARGET%의 모습이 이상하다….
	PRINTFORMW %조사처리(CALLNAME:TARGET,"는")% %CALLNAME:MASTER%의 아이를 임신한 모양이다.
	PRINTFORMW %조사처리(CALLNAME:TARGET,"는")% [%TALENTNAME:140%]했다.
	TALENT:TARGET:140 = 1
	CFLAG:70 = 1
	CALL CHANGE_N_STATUS, TARGET

	;임신시의 말을 이벤트 말로 해 보는 것은 좋다고 해 분기 어떻게 하지…
	;기본적으로는 말측에서 분기 받을 방향으로
	;TFLAG:222 를 말분기용 부친 관련＋굿 배드 판정용으로 사용
	TFLAG:222 = NO:MASTER + 1000
	CALL SELF_KOJO, TARGET, 170
	CALL CLEAR_FLAG


;고객과의 아이를 임신했다 처리
ELSEIF LOCAL == 1
	;고객을 일단 ASSI로서 추가
	LOCAL:2 = ASSI
	ADDCHARA 146
	ASSI = CHARANUM-1
	CFLAG:ASSI:3109 = FLAG:998
	CFLAG:ASSI:3111 = DAY
	FLAG:998 += 1
	PRINTFORML %CALLNAME:TARGET%의 모습이 이상하다….
	PRINTFORMW %조사처리(CALLNAME:TARGET,"는")% %CALLNAME:ASSI%의 아이를 임신한 모양이다.
	PRINTFORMW %조사처리(CALLNAME:TARGET,"는")% [%TALENTNAME:140%]했다.
	TALENT:TARGET:140 = 1
	CFLAG:70 = 2
	;[구애의존]
	IF TALENT:TARGET:261 == 1
		CFLAG:70 = 3
		TFLAG:200 = 1812
		;임신에 수반하는 스테이터스 변동
		CALL SPRING_CHANGE_N_STATUS, TARGET
	;[창부]
	ELSEIF TALENT:TARGET:260 == 1
		TFLAG:200 = 1811
		;임신에 수반하는 스테이터스 변동
		CALL SPRING_CHANGE_N_STATUS, TARGET
	ELSE
		TFLAG:200 = 1810
		CALL CHANGE_N_STATUS, TARGET
	ENDIF

	CALL SELF_KOJO, TARGET, 170
	CALL CLEAR_FLAG
	ASSI = LOCAL:2
	CALL SPRING_CHARA_GONE, CHARANUM-1, TARGET, ASSI
	;추가한 ASSI(고객)을 삭제
	DELCHARA CHARANUM-1

;죽어 분기이지만, 어떠한 이유로써 섞여 와지면(자) 버그의 원인 것은 축
ELSE
	COUNT = TARGET
	TARGET = LOCAL:1
	RETURN 0
ENDIF

COUNT = TARGET
TARGET = LOCAL:1
DRAWLINE
BASE:COUNT:0 = LOCAL:3
RETURN 0

;지우고 싶은 놈, 타겟, 갈대
@SPRING_CHARA_GONE, ARG, ARG:1, ARG:2
IF CFLAG:ARG:4 == 1024
	IF NO:ARG == 401
		IF FLAG:570 & 16
			TALENT:MASTER:149 = 0
			ABL:MASTER:98 = 0
		ELSEIF FLAG:570 & 32
			ABL:MASTER:98 = FLAG:572
		ENDIF
		FLAG:570 &= 15
	ELSEIF NO:MASTER == 400 && NO:ARG == 402 && FLAG:570 & 4
		FLAG:570 |= 2
		FLAG:570 &= 59
	ENDIF
	DELCHARA ARG
ENDIF

IF ARG:1 < 0 || ARG:1 == ARG
	TARGET = -1
ELSE
	TARGET = (ARG:1 > ARG) ?  (ARG:1 - 1) # ARG:1
ENDIF
IF ARG:2 < 0 || ARG:2 == ARG
	ASSI = -1
ELSE
	ASSI = (ARG:2 > ARG) ?  (ARG:2 - 1) # ARG:2
ENDIF

FLAG:996 = -1
IF TARGET >= 0
	RESULT = -1
	TRYCALLFORM TRY_{NO}
	FLAG:996 = RESULT
ENDIF

@SPRING_CHANGE_N_STATUS, ARG
;기본적으로 대상이 바뀌는 것만으로 같아서 함수에 묶음 냈다
;체력 상한을 줄인다
;체력이 상한 넘는 일도 있으므로, 체력 501이상이라면 500으로 한다
MAXBASE:ARG:0 -= 500

;출산계의 플래그 설정
CFLAG:ARG:77 = DAY + 20
LOCAL = ASSI

CFLAG:ARG:78 = NO:LOCAL
CFLAG:ARG:3004 = CFLAG:LOCAL:3109
LOCAL:1 = CFLAG:ARG:78 + 1000

;이쪽에 온 이상, 창녀나 구애 의존. 그 때문에, 문답 무용으로 굿 임신이 된다.
;다만, 창녀이면 굿 임신에서도 마이너스 소질이 붙는다.
IF CFLAG:ARG:70 == 3
	PRINTFORMW %조사처리(CALLNAME:ARG,"는")% 아버지를 모르는 아이를……
	PRINTFORMW 아니, 「자신을 사랑해 준 사람」의 자식을 받아서 기뻐하고 있다.
	PRINTL 
ELSE
	PRINTFORMW %조사처리(CALLNAME:ARG,"는")% 임신해서 곤혹 스러워하면서도 동시에 기뻐하고 있다.
	PRINTFORMW 누구의 자식인지 모르는게 불안하지만 크게 당황해하는 기색은 없다.
	PRINTFORMW 창녀로서 일하는 이상, 이러한 일은 각오하고 있었을지도 모른다.
	PRINTL 
ENDIF
	;임신(굿) 플래그
	CFLAG:ARG:76 = 1

	;임산부의 가슴의 크기를 플래그에 대입하는 처리
	CFLAG:ARG:3006 = 0
	;절벽
	IF TALENT:ARG:110 
		CFLAG:ARG:3006 = 1
	;빈유
	ELSEIF TALENT:ARG:111
		CFLAG:ARG:3006 = 2
	;큰 가슴
	ELSEIF TALENT:ARG:112
		CFLAG:ARG:3006 = 4
	;폭유
	ELSEIF TALENT:ARG:113
		CFLAG:ARG:3006 = 5
	;보통
	ELSE
		CFLAG:ARG:3006 = 3
	ENDIF

	;젖이 원 랭크 파워업 한다
	;절→빈빈→보보→거거·폭→그대로
	IF TALENT:ARG:112 == 0 && TALENT:ARG:113 == 0
		PRINTFORMW %CALLNAME:ARG%의 가슴이 커졌다.
		IF TALENT:ARG:110 == 1
			PRINTFORMW [%TALENTNAME:110%]에서 [%TALENTNAME:111%]로 바뀌었다.
			TALENT:ARG:110 = 0
			TALENT:ARG:111 = 1
		ELSEIF TALENT:ARG:111 == 1
			PRINTFORMW [%TALENTNAME:111%]에서 보통 크기로 변했다.
			TALENT:ARG:111 = 0
		ELSE
			PRINTFORMW [%TALENTNAME:112%]가 되었다.
			TALENT:ARG:112 = 1
		ENDIF
		PRINTL 
	ENDIF

	;모유 나오게 된다
	IF TALENT:ARG:134 == 0
		PRINTFORMW %조사처리(CALLNAME:ARG,"는")% 모유가 나오게 되었다.
		PRINTL 
		TALENT:ARG:134 = 1
	ELSE
		;벌써 모유 체질의 경우는 그 플래그를 가져 둔다
		MARK:ARG:89 = 1
	ENDIF

	;소질 변동 처리의 호출
	CALL LOST_TALENTS, ARG, 11, 0
	CALL LOST_TALENTS, ARG, 20, RESULT
	CALL LOST_TALENTS, ARG, 21, RESULT
	CALL LOST_TALENTS, ARG, 22, RESULT
	CALL LOST_TALENTS, ARG, 27, RESULT
	CALL LOST_TALENTS, ARG, 32, RESULT
	CALL LOST_TALENTS, ARG, 34, RESULT
	CALL LOST_TALENTS, ARG, 38 - TALENT:LOCAL:120, RESULT
	CALL LOST_TALENTS, ARG, 39, RESULT

	SIF RESULT != 0
		PRINTFORMW 을 \@(RESULT == 2) ? 얻었다 # 잃었다\@

IF CFLAG:ARG:70 != 3 && TALENT:ARG:150 && TALENT:ARG:153 == 0
	PRINTFORML %조사처리(CALLNAME:ARG,"는")% 누군지 알 수 없는 아이를 임신한 뒤 자신의 입장과 운명을 깨닫았다.
	PRINTFORMW %CALLNAME:MASTER%에게 바친 사랑은 마음속에 묻어두기로 했다.
	PRINTFORMW %조사처리(CALLNAME:ARG,"는")% [%TALENTNAME:150%]를 잃고 [%TALENTNAME:261%]를 얻었다.
	TALENT:ARG:150 = 0
	TALENT:ARG:261 = 1
ENDIF
DRAWLINE
