;=============================================================================
;소스 계산(쾌락계)
;=============================================================================
;-------------------------------------------------
;쾌Ｃ의 소스
;-------------------------------------------------
@CALC_SOURCE0
;Ｃ민감과 Ｃ둔감은 여기서 처리
IF TALENT:100
	TIMES SOURCE:0 , 2.00
ELSEIF TALENT:101
	TIMES SOURCE:0 , 0.50
ENDIF

LOCAL = SOURCE:0

;PALAM:욕정을 본다
IF PALAM:13 < PALAMLV:1
	TIMES LOCAL , 0.50
ELSEIF PALAM:13 < PALAMLV:2
	TIMES LOCAL , 0.70
ELSEIF PALAM:13 < PALAMLV:3
	TIMES LOCAL , 1.00
ELSEIF PALAM:13 < PALAMLV:4
	TIMES LOCAL , 1.30
ELSE
	TIMES LOCAL , 1.80
ENDIF

LOCAL:1 = SOURCE:0

;ABL:욕망을 본다
IF ABL:11 == 0
	TIMES LOCAL:1 , 0.10
ELSEIF ABL:11 == 1
	TIMES LOCAL:1 , 0.15
ELSEIF ABL:11 == 2
	TIMES LOCAL:1 , 0.20
ELSEIF ABL:11 == 3
	TIMES LOCAL:1 , 0.25
ELSEIF ABL:11 == 4
	TIMES LOCAL:1 , 0.30
ELSE
	TIMES LOCAL:1 , 0.40
ENDIF

;쾌감을 부정, 억압, 저항
IF TALENT:32 || TALENT:34 || TALENT:71
	LOCAL:2 = SOURCE:0 / 3
	LOCAL:2 = CALC_CVAB_SOURCE_SUB(LOCAL:2)
ELSE
	LOCAL:2 = 0
ENDIF

LOCAL:3 = 0

;도구계 커맨드 실행시에 실행자가 [음구지식]을 가지고 있다
SIF (TFLAG:98 == 1 && TALENT:PLAYER:58) || (TFLAG:98 == 2 && TALENT:58)
	TIMES LOCAL , 1.50

;도구계 커맨드 실행시에 실행자가 [츠쿠모가미]를 가지고 있다
SIF (TFLAG:98 == 1 && TALENT:PLAYER:228) || (TFLAG:98 == 2 && TALENT:228)
	TIMES LOCAL , 1.30
;음핵／음경
IF TALENT:171
	TIMES LOCAL , 1.50
	TIMES LOCAL:1 , 1.20
	TIMES LOCAL:2 , 0.50
	LOCAL:3 = (LOCAL+LOCAL:1)/2
ENDIF

UP:0 += LOCAL
UP:13 += LOCAL:1
UP:22 += LOCAL:2
;음핵／음경持ちが対象なら潤滑と習得のパラも上昇する
IF LOCAL:3
	UP:10 += LOCAL:3
	LOCAL:3 = (LOCAL+LOCAL:1)/3
	UP:11 += LOCAL:3
ENDIF

;-------------------------------------------------
;쾌Ｖ의 소스
;-------------------------------------------------
@CALC_SOURCE1
;Ｖ민감과 Ｖ둔감은 여기서 처리
IF TALENT:102
	TIMES SOURCE:1 , 2.00
ELSEIF TALENT:103
	TIMES SOURCE:1 , 0.50
ENDIF

LOCAL = SOURCE:1

;PALAM:욕정을 본다
IF PALAM:13 < PALAMLV:1
	TIMES LOCAL , 0.30
ELSEIF PALAM:13 < PALAMLV:2
	TIMES LOCAL , 0.50
ELSEIF PALAM:13 < PALAMLV:3
	TIMES LOCAL , 1.00
ELSEIF PALAM:13 < PALAMLV:4
	TIMES LOCAL , 1.50
ELSE
	TIMES LOCAL , 2.00
ENDIF

LOCAL:1 = SOURCE:1

;ABL:욕망을 본다
IF ABL:11 == 0
	TIMES LOCAL:1 , 0.10
ELSEIF ABL:11 == 1
	TIMES LOCAL:1 , 0.15
ELSEIF ABL:11 == 2
	TIMES LOCAL:1 , 0.20
ELSEIF ABL:11 == 3
	TIMES LOCAL:1 , 0.25
ELSEIF ABL:11 == 4
	TIMES LOCAL:1 , 0.30
ELSE
	TIMES LOCAL:1 , 0.40
ENDIF

;쾌감을 부정, 억압, 저항
IF TALENT:32 || TALENT:34 || TALENT:71
	LOCAL:2 = SOURCE:1 / 3
	LOCAL:2 = CALC_CVAB_SOURCE_SUB(LOCAL:2)
ELSE
	LOCAL:2 = 0
ENDIF

LOCAL:3 = 0

;도구계 커맨드 실행시에 실행자가 [음구지식]을 가지고 있다
SIF (TFLAG:98 == 1 && TALENT:PLAYER:58) || (TFLAG:98 == 2 && TALENT:58)
	TIMES LOCAL , 1.50
;도구계 커맨드 실행시에 실행자가 [츠쿠모가미]를 가지고 있다
SIF (TFLAG:98 == 1 && TALENT:PLAYER:228) || (TFLAG:98 == 2 && TALENT:228)
	TIMES LOCAL , 1.30
;小人体型
IF TALENT:127
	TIMES LOCAL , 0.80
	TIMES LOCAL:1 , 1.20
	TIMES LOCAL:2 , 1.20
	UP:15 += LOCAL:1/2
ENDIF
;淫壷
IF TALENT:172
	IF PLAYER == MASTER
		TIMES LOCAL , 2.50
		TIMES LOCAL:1 , 1.50
		TIMES LOCAL:2 , 0.30
	ELSE
		TIMES LOCAL , 1.50
		TIMES LOCAL:1 , 1.20
		TIMES LOCAL:2 , 0.50
	ENDIF
	LOCAL:3 = (LOCAL+LOCAL:1)/3
ENDIF

UP:1 += LOCAL
UP:12 += LOCAL:1
UP:13 += LOCAL:1
UP:22 += LOCAL:2
;淫壷持ちが対象なら潤滑のパラも上昇する
SIF LOCAL:3
	UP:10 += LOCAL:3

;-------------------------------------------------
;쾌Ａ의 소스
;-------------------------------------------------
@CALC_SOURCE2
;Ａ민감과 Ａ둔감은 여기서 처리
IF TALENT:104
	TIMES SOURCE:2 , 2.00
ELSEIF TALENT:105
	TIMES SOURCE:2 , 0.50
ENDIF

LOCAL = SOURCE:2

;PALAM:욕정을 본다
;쾌ＡはあまりPALAM:욕정では差が出ない
IF PALAM:13 < PALAMLV:1
	TIMES LOCAL , 0.60
ELSEIF PALAM:13 < PALAMLV:2
	TIMES LOCAL , 0.80
ELSEIF PALAM:13 < PALAMLV:3
	TIMES LOCAL , 1.00
ELSEIF PALAM:13 < PALAMLV:4
	TIMES LOCAL , 1.20
ELSE
	TIMES LOCAL , 1.40
ENDIF

LOCAL:1 = SOURCE:2

;ABL:욕망을 본다
IF ABL:11 == 0
	TIMES LOCAL:1 , 0.05
ELSEIF ABL:11 == 1
	TIMES LOCAL:1 , 0.10
ELSEIF ABL:11 == 2
	TIMES LOCAL:1 , 0.40
ELSEIF ABL:11 == 3
	TIMES LOCAL:1 , 0.80
ELSEIF ABL:11 == 4
	TIMES LOCAL:1 , 1.20
ELSE
	TIMES LOCAL:1 , 1.80
ENDIF

;쾌감을 부정, 억압, 저항
IF TALENT:32 || TALENT:34 || TALENT:71
	LOCAL:2 = SOURCE:2 / 3
	LOCAL:2 = CALC_CVAB_SOURCE_SUB(LOCAL:2)
ELSE
	LOCAL:2 = 0
ENDIF

;도구계 커맨드 실행시에 실행자가 [음구지식]을 가지고 있다
SIF (TFLAG:98 == 1 && TALENT:PLAYER:58) || (TFLAG:98 == 2 && TALENT:58)
	TIMES LOCAL , 1.50
;도구계 커맨드 실행시에 실행자가 [츠쿠모가미]를 가지고 있다
SIF (TFLAG:98 == 1 && TALENT:PLAYER:228) || (TFLAG:98 == 2 && TALENT:228)
	TIMES LOCAL , 1.30
;小人体型
IF TALENT:127
	TIMES LOCAL , 0.50
	TIMES LOCAL:1 , 1.50
	TIMES LOCAL:2 , 1.20
	UP:17 += LOCAL/2
	UP:21 += LOCAL:1/2
ENDIF
;淫尻
IF TALENT:173
	TIMES LOCAL , 1.50
	TIMES LOCAL:1 , 1.20
	TIMES LOCAL:2 , 0.50
ENDIF

UP:2 += LOCAL
UP:13 += LOCAL:1
UP:14 += LOCAL:1
UP:22 += LOCAL:2

;-------------------------------------------------
;쾌Ｂ의 소스
;-------------------------------------------------
@CALC_SOURCE3
;Ｂ민감과 Ｂ둔감은 여기서 처리
IF TALENT:106
	TIMES SOURCE:3 , 2.00
ELSEIF TALENT:107
	TIMES SOURCE:3 , 0.50
ENDIF

LOCAL = SOURCE:3

;PALAM:욕정을 본다
IF PALAM:13 < PALAMLV:1
	TIMES LOCAL , 0.50
ELSEIF PALAM:13 < PALAMLV:2
	TIMES LOCAL , 0.70
ELSEIF PALAM:13 < PALAMLV:3
	TIMES LOCAL , 1.00
ELSEIF PALAM:13 < PALAMLV:4
	TIMES LOCAL , 1.30
ELSE
	TIMES LOCAL , 1.80
ENDIF

LOCAL:1 = SOURCE:3

;ABL:욕망을 본다
IF ABL:11 == 0
	TIMES LOCAL:1 , 0.10
ELSEIF ABL:11 == 1
	TIMES LOCAL:1 , 0.15
ELSEIF ABL:11 == 2
	TIMES LOCAL:1 , 0.20
ELSEIF ABL:11 == 3
	TIMES LOCAL:1 , 0.25
ELSEIF ABL:11 == 4
	TIMES LOCAL:1 , 0.30
ELSE
	TIMES LOCAL:1 , 0.40
ENDIF

;쾌감을 부정, 억압, 저항
IF TALENT:32 || TALENT:34 || TALENT:71
	LOCAL:2 = SOURCE:3 / 3
	LOCAL:2 = CALC_CVAB_SOURCE_SUB(LOCAL:2)
ELSE
	LOCAL:2 = 0
ENDIF

;도구계 커맨드 실행시에 실행자가 [음구지식]을 가지고 있다
SIF (TFLAG:98 == 1 && TALENT:PLAYER:58) || (TFLAG:98 == 2 && TALENT:58)
	TIMES LOCAL , 1.50

;도구계 커맨드 실행시에 실행자가 [츠쿠모가미]를 가지고 있다
SIF (TFLAG:98 == 1 && TALENT:PLAYER:228) || (TFLAG:98 == 2 && TALENT:228)
	TIMES LOCAL , 1.30

;小人体型
IF TALENT:127
	TIMES LOCAL , 1.50
	TIMES LOCAL:1 , 1.20
	TIMES LOCAL:2 , 1.20
	UP:12 += LOCAL:1/2
ENDIF
;淫乳
IF TALENT:174
	TIMES LOCAL , 1.50
	TIMES LOCAL:1 , 1.20
	TIMES LOCAL:2 , 0.50
ENDIF

UP:3 += LOCAL
UP:13 += LOCAL:1
UP:22 += LOCAL:2

;-------------------------------------------------
;쾌楽의 소스補助計算
;-------------------------------------------------
;………………………………………………
;쾌감을 부정, 억압, 저항による抑鬱上昇
;………………………………………………
@CALC_CVAB_SOURCE_SUB(ARG)
#FUNCTION
;ABL:욕망을 본다
IF ABL:11 == 0
	TIMES ARG , 1.00
ELSEIF ABL:11 == 1
	TIMES ARG , 0.85
ELSEIF ABL:11 == 2
	TIMES ARG , 0.70
ELSEIF ABL:11 == 3
	TIMES ARG , 0.40
ELSEIF ABL:11 == 4
	TIMES ARG , 0.30
ELSE
	TIMES ARG , 0.10
ENDIF
RETURNF ARG

;=============================================================================
;ソース計算(快楽以外)
;=============================================================================
;-------------------------------------------------
;接触의 소스
;-------------------------------------------------
;bluemoon様のものを勝手に拝借・手直ししました
@CALC_SOURCE10
LOCAL = SOURCE:10
LOCAL:1 = SOURCE:10
LOCAL:2 = SOURCE:10
LOCAL:3 = SOURCE:10

;ABL:순종을 본다
IF ABL:10 == 0
	TIMES LOCAL , 1.00
	TIMES LOCAL:1 , 0.00
ELSEIF ABL:10 == 1
	TIMES LOCAL , 0.80
	TIMES LOCAL:1 , 0.05
ELSEIF ABL:10 == 2
	TIMES LOCAL , 0.60
	TIMES LOCAL:1 , 0.10
ELSEIF ABL:10 == 3
	TIMES LOCAL , 0.30
	TIMES LOCAL:1 , 0.20
ELSEIF ABL:10 == 4
	TIMES LOCAL , 0.10
	TIMES LOCAL:1 , 0.30
ELSE
	TIMES LOCAL , 0.00
	TIMES LOCAL:1 , 0.40
ENDIF

;ABL:욕망을 본다
IF ABL:11 == 0
	TIMES LOCAL:2 , 0.50
	TIMES LOCAL:3 , 0.00
ELSEIF ABL:11 == 1
	TIMES LOCAL:2 , 0.40
	TIMES LOCAL:3 , 0.05
ELSEIF ABL:11 == 2
	TIMES LOCAL:2 , 0.25
	TIMES LOCAL:3 , 0.10
ELSEIF ABL:11 == 3
	TIMES LOCAL:2 , 0.10
	TIMES LOCAL:3 , 0.20
ELSEIF ABL:11 == 4
	TIMES LOCAL:2 , 0.00
	TIMES LOCAL:3 , 0.30
ELSE
	TIMES LOCAL:2 , 0.00
	TIMES LOCAL:3 , 0.40
ENDIF

;恋慕
IF TALENT:150 && ASSIPLAY == 0
	LOCAL /= 5
	LOCAL:2 /= 5
	LOCAL:1 *= 2
	LOCAL:3 *= 2
ENDIF

;レズ調教・ＢＬ調教の場合
IF !(TALENT:PLAYER:120 ^^ TALENT:120)
	IF ABL:(22 + TALENT:120) == 0
		TIMES LOCAL , 1.00
		TIMES LOCAL:2 , 1.00
		TIMES LOCAL:1 , 1.00
		TIMES LOCAL:3 , 1.00
	ELSEIF ABL:(22 + TALENT:120) == 1
		TIMES LOCAL , 0.80
		TIMES LOCAL:2 , 0.80
		TIMES LOCAL:1 , 1.10
		TIMES LOCAL:3 , 1.10
	ELSEIF ABL:(22 + TALENT:120) == 2
		TIMES LOCAL , 0.60
		TIMES LOCAL:2 , 0.60
		TIMES LOCAL:1 , 1.20
		TIMES LOCAL:3 , 1.20
	ELSEIF ABL:(22 + TALENT:120) == 3
		TIMES LOCAL , 0.40
		TIMES LOCAL:2 , 0.40
		TIMES LOCAL:1 , 1.30
		TIMES LOCAL:3 , 1.30
	ELSEIF ABL:(22 + TALENT:120) == 4
		TIMES LOCAL , 0.25
		TIMES LOCAL:2 , 0.25
		TIMES LOCAL:1 , 1.40
		TIMES LOCAL:3 , 1.40
	ELSE
		TIMES LOCAL , 0.15
		TIMES LOCAL:2 , 0.15
		TIMES LOCAL:1 , 1.50
		TIMES LOCAL:3 , 1.50
	ENDIF
ENDIF

;相性（この後出てくる「相性による上下の処理」と二重計算になるが問題なし）
LOCAL:4 = NO:PLAYER
IF RELATION:(LOCAL:4) != 0
	LOCAL *= 100
	LOCAL /= RELATION:(LOCAL:4)
	LOCAL:2 *= 100
	LOCAL:2 /= RELATION:(LOCAL:4)

	LOCAL:1 *= RELATION:(LOCAL:4)
	LOCAL:1 /= 100
	LOCAL:3 *= RELATION:(LOCAL:4)
	LOCAL:3 /= 100
ENDIF

UP:20 += LOCAL
UP:12 += LOCAL:1
UP:21 += LOCAL:2
UP:13 += LOCAL:3

;-------------------------------------------------
;情愛의 소스
;-------------------------------------------------
@CALC_SOURCE11
LOCAL = SOURCE:11

;ABL:순종을 본다
IF ABL:10 == 0
	TIMES LOCAL , 0.10
ELSEIF ABL:10 == 1
	TIMES LOCAL , 0.25
ELSEIF ABL:10 == 2
	TIMES LOCAL , 0.40
ELSEIF ABL:10 == 3
	TIMES LOCAL , 0.60
ELSEIF ABL:10 == 4
	TIMES LOCAL , 0.80
ELSE
	TIMES LOCAL , 1.00
ENDIF

LOCAL:1 = SOURCE:11

;ABL:욕망을 본다
IF ABL:11 == 0
	TIMES LOCAL:1 , 0.00
ELSEIF ABL:11 == 1
	TIMES LOCAL:1 , 0.05
ELSEIF ABL:11 == 2
	TIMES LOCAL:1 , 0.10
ELSEIF ABL:11 == 3
	TIMES LOCAL:1 , 0.20
ELSEIF ABL:11 == 4
	TIMES LOCAL:1 , 0.30
ELSE
	TIMES LOCAL:1 , 0.40
ENDIF

;인형
IF TALENT:208
	TIMES LOCAL , 1.50
	TIMES LOCAL:1 , 1.25
ENDIF

;사토리
IF TALENT:213
	TIMES LOCAL , 1.20
	TIMES LOCAL:1 , 1.10
ENDIF

;츠쿠모가미
IF TALENT:228
	TIMES LOCAL , 1.50
	TIMES LOCAL:1 , 1.25
ENDIF

UP:12 += LOCAL
UP:13 += LOCAL:1

;-------------------------------------------------
;노출의 소스
;-------------------------------------------------
@CALC_SOURCE12
;恥じらいと恥薄いはここで処理
IF TALENT:35
	TIMES SOURCE:12 , 2.00
ELSEIF TALENT:36
	TIMES SOURCE:12 , 0.50
ENDIF

;潤滑アップの50%から液体追加의 소스を引いた残りを露出의 소스に加える
SOURCE:12 += (UP:10 - SOURCE:19) / 2

LOCAL = SOURCE:12
LOCAL:1 = SOURCE:12
LOCAL:2 = SOURCE:12

;PALAM:치정을 본다
;恥ずかしさを感じれば感じるほどあまり恥ずかしくなくなる
IF PALAM:15 < PALAMLV:1
	TIMES LOCAL:1 , 1.00
ELSEIF PALAM:15 < PALAMLV:2
	TIMES LOCAL:1 , 0.90
ELSEIF PALAM:15 < PALAMLV:3
	TIMES LOCAL:1 , 0.70
ELSEIF PALAM:15 < PALAMLV:4
	TIMES LOCAL:1 , 0.50
ELSE
	TIMES LOCAL:1 , 0.30
ENDIF

;ABL:순종을 본다
IF ABL:10 == 0
	TIMES LOCAL:2 , 0.50
ELSEIF ABL:10 == 1
	TIMES LOCAL:2 , 0.30
ELSEIF ABL:10 == 2
	TIMES LOCAL:2 , 0.15
ELSEIF ABL:10 == 3
	TIMES LOCAL:2 , 0.05
ELSEIF ABL:10 == 4
	TIMES LOCAL:2 , 0.00
ELSE
	TIMES LOCAL:2 , 0.00
ENDIF

;ABL:노출벽을 본다
IF ABL:14 == 0
	TIMES LOCAL , 0.00
	TIMES LOCAL:2 , 1.00
ELSEIF ABL:14 == 1
	TIMES LOCAL , 0.10
	TIMES LOCAL:2 , 0.90
ELSEIF ABL:14 == 2
	TIMES LOCAL , 0.20
	TIMES LOCAL:2 , 0.70
ELSEIF ABL:14 == 3
	TIMES LOCAL , 0.40
	TIMES LOCAL:2 , 0.50
ELSEIF ABL:14 == 4
	TIMES LOCAL , 0.60
	TIMES LOCAL:2 , 0.30
ELSE
	TIMES LOCAL , 0.80
	TIMES LOCAL:2 , 0.10
ENDIF

;パイパン
IF TALENT:65
	TIMES LOCAL:1 , 2.50
	TIMES LOCAL:2 , 1.50
ENDIF
;マゾ
IF TALENT:82
	TIMES LOCAL , 1.50
	TIMES LOCAL:1 , 1.50
	TIMES LOCAL:2 , 0.50
ENDIF

;クリトリスリング
IF CFLAG:42 & 1
	TIMES LOCAL:1 , 1.25
	TIMES LOCAL:2 , 1.40
ENDIF
;ラビアピアス
IF CFLAG:42 & 16
	TIMES LOCAL:1 , 1.30
	TIMES LOCAL:2 , 1.50
ENDIF
;ニプルピアス
IF CFLAG:42 & 32
	TIMES LOCAL:1 , 1.80
	TIMES LOCAL:2 , 1.30
ENDIF

UP:13 += LOCAL
UP:15 += LOCAL:1
UP:20 += LOCAL:2

;-------------------------------------------------
;主導権의 소스
;-------------------------------------------------
@CALC_SOURCE14
LOCAL = SOURCE:14 / 5
LOCAL:1 = SOURCE:14
LOCAL:2 = SOURCE:14 / 2

;PALAM:욕정을 본다
IF PALAM:13 < PALAMLV:1
	TIMES LOCAL , 0.50
	TIMES LOCAL:1 , 0.10
	TIMES LOCAL:2 , 1.00
ELSEIF PALAM:13 < PALAMLV:2
	TIMES LOCAL , 0.70
	TIMES LOCAL:1 , 0.25
	TIMES LOCAL:2 , 1.20
ELSEIF PALAM:13 < PALAMLV:3
	TIMES LOCAL , 1.00
	TIMES LOCAL:1 , 0.50
	TIMES LOCAL:2 , 1.50
ELSEIF PALAM:13 < PALAMLV:4
	TIMES LOCAL , 1.30
	TIMES LOCAL:1 , 0.75
	TIMES LOCAL:2 , 1.80
ELSE
	TIMES LOCAL , 1.80
	TIMES LOCAL:1 , 1.00
	TIMES LOCAL:2 , 2.50
ENDIF

;ABL:技巧을 본다
IF ABL:12 == 0
	TIMES LOCAL , 1.00
	TIMES LOCAL:2 , 0.80
ELSEIF ABL:12 == 1
	TIMES LOCAL , 1.25
	TIMES LOCAL:2 , 1.00
ELSEIF ABL:12 == 2
	TIMES LOCAL , 1.50
	TIMES LOCAL:2 , 1.20
ELSEIF ABL:12 == 3
	TIMES LOCAL , 1.80
	TIMES LOCAL:2 , 1.40
ELSEIF ABL:12 == 4
	TIMES LOCAL , 2.00
	TIMES LOCAL:2 , 1.60
ELSE
	TIMES LOCAL , 2.40
	TIMES LOCAL:2 , 1.80
ENDIF

;ABL:봉사정신을 본다
IF ABL:13 == 0
	TIMES LOCAL:1 , 1.00
	TIMES LOCAL:2 , 1.00
ELSEIF ABL:13 == 1
	TIMES LOCAL:1 , 1.00
	TIMES LOCAL:2 , 0.90
ELSEIF ABL:13 == 2
	TIMES LOCAL:1 , 0.90
	TIMES LOCAL:2 , 0.80
ELSEIF ABL:13 == 3
	TIMES LOCAL:1 , 0.90
	TIMES LOCAL:2 , 0.70
ELSEIF ABL:13 == 4
	TIMES LOCAL:1 , 0.75
	TIMES LOCAL:2 , 0.60
ELSE
	TIMES LOCAL:1 , 0.75
	TIMES LOCAL:2 , 0.50
ENDIF

;ABL:マゾっ気을 본다
IF ABL:21 == 0
	TIMES LOCAL:2 , 1.00
ELSEIF ABL:21 == 1
	TIMES LOCAL:2 , 0.90
ELSEIF ABL:21 == 2
	TIMES LOCAL:2 , 0.80
ELSEIF ABL:21 == 3
	TIMES LOCAL:2 , 0.70
ELSEIF ABL:21 == 4
	TIMES LOCAL:2 , 0.60
ELSE
	TIMES LOCAL:2 , 0.50
ENDIF

;サド
IF TALENT:81
	TIMES LOCAL:1 , 1.50
	TIMES LOCAL:2 , 1.25
ENDIF

;調教者がマゾ
IF TALENT:PLAYER:82
	TIMES LOCAL:1 , 1.50
	TIMES LOCAL:2 , 1.50
ENDIF

UP:11 += LOCAL
UP:13 += LOCAL:1

;ABL:순종을 본다
IF ABL:10 == 0
	TIMES LOCAL:2 , 1.00
ELSEIF ABL:10 == 1
	TIMES LOCAL:2 , 0.80
ELSEIF ABL:10 == 2
	TIMES LOCAL:2 , 0.60
ELSEIF ABL:10 == 3
	TIMES LOCAL:2 , 0.50
ELSEIF ABL:10 == 4
	TIMES LOCAL:2 , 0.80
ELSE
	TIMES LOCAL:2 , 1.00
ENDIF

IF ABL:10 < 4
	UP:14 += LOCAL:2
ELSE
	;MARK:反発刻印을 본다
	IF MARK:9 == 0
		TIMES LOCAL:2 , 1.00
	ELSEIF MARK:9 == 1
		TIMES LOCAL:2 , 0.75
	ELSEIF MARK:9 == 2
		TIMES LOCAL:2 , 0.50
	ELSE
		TIMES LOCAL:2 , 0.25
	ENDIF
	UP:32 += LOCAL:2
ENDIF

;-------------------------------------------------
;性行動의 소스
;-------------------------------------------------
@CALC_SOURCE15
LOCAL = SOURCE:15
LOCAL:1 = 0

;ABL:봉사정신을 본다
IF ABL:13 == 0
	TIMES LOCAL , 0.60
ELSEIF ABL:13 == 1
	TIMES LOCAL , 0.80
ELSEIF ABL:13 == 2
	TIMES LOCAL , 1.00
ELSEIF ABL:13 == 3
	TIMES LOCAL , 1.20
ELSEIF ABL:13 == 4
	TIMES LOCAL , 1.40
ELSE
	TIMES LOCAL , 1.70
ENDIF

;調教者が[オトコ]の場合は＋補正
;主人調教なら補正率アップかつ[淫壷]補正あり
IF TALENT:PLAYER:120 && ASSIPLAY == 0
	TIMES LOCAL , 1.75
	SIF TALENT:172
		TIMES LOCAL , 1.20
ELSEIF TALENT:PLAYER:120
	TIMES LOCAL , 1.50
ENDIF

;억압か저항がある場合はPALAM:抑鬱が上がる
IF TALENT:32 || TALENT:34
	LOCAL:1 = SOURCE:15 / 5
	;ABL:봉사정신을 본다
	IF ABL:13 == 0
		TIMES LOCAL:1 , 1.80
	ELSEIF ABL:13 == 1
		TIMES LOCAL:1 , 1.30
	ELSEIF ABL:13 == 2
		TIMES LOCAL:1 , 0.90
	ELSEIF ABL:13 == 3
		TIMES LOCAL:1 , 0.70
	ELSEIF ABL:13 == 4
		TIMES LOCAL:1 , 0.50
	ELSE
		TIMES LOCAL:1 , 0.30
	ENDIF
ENDIF

UP:11 += LOCAL
UP:22 += LOCAL:1

;-------------------------------------------------
;達成의 소스
;-------------------------------------------------
@CALC_SOURCE16
LOCAL = SOURCE:16

;ABL:순종을 본다
IF ABL:10 == 0
	TIMES LOCAL , 0.50
ELSEIF ABL:10 == 1
	TIMES LOCAL , 0.80
ELSEIF ABL:10 == 2
	TIMES LOCAL , 1.00
ELSEIF ABL:10 == 3
	TIMES LOCAL , 1.20
ELSEIF ABL:10 == 4
	TIMES LOCAL , 1.40
ELSE
	TIMES LOCAL , 1.60
ENDIF

;ABL:봉사정신을 본다
IF ABL:13 == 0
	TIMES LOCAL , 0.00
ELSEIF ABL:13 == 1
	TIMES LOCAL , 0.40
ELSEIF ABL:13 == 2
	TIMES LOCAL , 0.80
ELSEIF ABL:13 == 3
	TIMES LOCAL , 1.20
ELSEIF ABL:13 == 4
	TIMES LOCAL , 1.60
ELSE
	TIMES LOCAL , 2.00
ENDIF

;調教者が[オトコ]の場合は＋補正
;主人調教なら補正率アップかつ[淫壷]補正あり
IF TALENT:PLAYER:120 && ASSIPLAY == 0
	TIMES LOCAL , 1.50
	SIF TALENT:172
		TIMES LOCAL , 1.10
ELSEIF TALENT:PLAYER:120
	TIMES LOCAL , 1.25
ENDIF

UP:12 += LOCAL

;-------------------------------------------------
;恭順追加의 소스
;-------------------------------------------------
@CALC_SOURCE17
LOCAL = SOURCE:17

;傷物
SIF TALENT:163
	TIMES LOCAL , 0.50

UP:12 += LOCAL

;-------------------------------------------------
;욕정追加의 소스
;-------------------------------------------------
@CALC_SOURCE18
LOCAL = SOURCE:18

UP:13 += LOCAL

;-------------------------------------------------
;液体追加의 소스
;-------------------------------------------------
@CALC_SOURCE19
;小人体型
IF TALENT:127 && TALENT:PLAYER:127 == 0
	;ローションとローションプレイでないときは
	SIF SELECTCOM != 60 && SELECTCOM != 625
		TIMES SOURCE:19 , 0.40
ENDIF
LOCAL = SOURCE:19

UP:10 += LOCAL

;-------------------------------------------------
;痛覚의 소스
;-------------------------------------------------
@CALC_SOURCE20
LOCAL = SOURCE:20
LOCAL:1 = SOURCE:20
LOCAL:2 = SOURCE:20
LOCAL:3 = SOURCE:20

;ABL:순종을 본다
IF ABL:10 == 0
	TIMES LOCAL:1 , 1.00
	TIMES LOCAL:2 , 0.80
ELSEIF ABL:10 == 1
	TIMES LOCAL:1 , 0.90
	TIMES LOCAL:2 , 0.60
ELSEIF ABL:10 == 2
	TIMES LOCAL:1 , 0.80
	TIMES LOCAL:2 , 0.50
ELSEIF ABL:10 == 3
	TIMES LOCAL:1 , 0.70
	TIMES LOCAL:2 , 0.40
ELSEIF ABL:10 == 4
	TIMES LOCAL:1 , 0.60
	TIMES LOCAL:2 , 0.20
ELSE
	TIMES LOCAL:1 , 0.50
	TIMES LOCAL:2 , 0.05
ENDIF

;ABL:マゾっ気을 본다
IF ABL:21 == 0
	TIMES LOCAL:2 , 1.00
	TIMES LOCAL:3 , 0.00
ELSEIF ABL:21 == 1
	TIMES LOCAL:2 , 0.80
	TIMES LOCAL:3 , 0.10
ELSEIF ABL:21 == 2
	TIMES LOCAL:2 , 0.50
	TIMES LOCAL:3 , 0.20
ELSEIF ABL:21 == 3
	TIMES LOCAL:2 , 0.30
	TIMES LOCAL:3 , 0.30
ELSEIF ABL:21 == 4
	TIMES LOCAL:2 , 0.10
	TIMES LOCAL:3 , 0.45
ELSE
	TIMES LOCAL:2 , 0.05
	TIMES LOCAL:3 , 0.60
ENDIF

;痛みに弱い
IF TALENT:40
	;難易度による修整
	IF FLAG:3 >= 4
		TIMES LOCAL , 4.00
	ELSEIF FLAG:3 == 3
		TIMES LOCAL , 2.00
	ELSE
		TIMES LOCAL , 1.50
	ENDIF
ENDIF
;ドＭ
IF TALENT:178
	TIMES LOCAL , 1.50
	TIMES LOCAL:2 , 0.50
	TIMES LOCAL:3 , 2.50
;マゾ
ELSEIF TALENT:82
	TIMES LOCAL:2 , 0.50
	TIMES LOCAL:3 , 1.50
ENDIF
;도구계 커맨드 실행시에 실행자가 [음구지식]을 가지고 있다
SIF (TFLAG:98 == 1 && TALENT:PLAYER:58) || (TFLAG:98 == 2 && TALENT:58)
	TIMES LOCAL , 1.50

;도구계 커맨드 실행시에 실행자가 [츠쿠모가미]를 가지고 있다
SIF (TFLAG:98 == 1 && TALENT:PLAYER:228) || (TFLAG:98 == 2 && TALENT:228)
	TIMES LOCAL , 1.30

;小人体型
IF TALENT:127
	TIMES LOCAL , 2.00
	TIMES LOCAL:1 , 1.20
	TIMES LOCAL:2 , 1.20
	TIMES LOCAL:3 , 0.75
ENDIF

;助手によるプレイ
SIF ASSIPLAY
	TIMES LOCAL:2 , 0.40

;ABL:調教者のサドっ気을 본다
IF ABL:PLAYER:20 == 0
	TIMES LOCAL , 1.00
	TIMES LOCAL:1 , 1.00
	TIMES LOCAL:2 , 1.00
ELSEIF ABL:PLAYER:20 <= 2
	TIMES LOCAL , 1.10
	TIMES LOCAL:1 , 1.10
	TIMES LOCAL:2 , 1.20
ELSEIF ABL:PLAYER:20 <= 4
	TIMES LOCAL , 1.20
	TIMES LOCAL:1 , 1.25
	TIMES LOCAL:2 , 1.40
ELSE
	TIMES LOCAL , 1.40
	TIMES LOCAL:1 , 1.50
	TIMES LOCAL:2 , 1.80
ENDIF

;調教者がドＳ
IF TALENT:PLAYER:177
	TIMES LOCAL , 2.00
	TIMES LOCAL:3 , 1.50
;調教者がサド
ELSEIF TALENT:PLAYER:81
	TIMES LOCAL , 1.20
	TIMES LOCAL:3 , 1.50
ENDIF

UP:16 += LOCAL
UP:17 += LOCAL:1
UP:20 += LOCAL:2
UP:13 += LOCAL:3
;マゾっ気があるとPALAM:욕정も上がる
;そのとき調教者が[サド]だと効果的

;-------------------------------------------------
;痒み의 소스
;-------------------------------------------------
@CALC_SOURCE21
;LOCAL:0=苦痛,욕정
;LOCAL:1=屈服
;LOCAL:2=不快
;LOCAL:3=反感

LOCAL = SOURCE:21
LOCAL:1 = SOURCE:21
LOCAL:2 = 4 * SOURCE:21

IF SOURCE:21 < 1000
	LOCAL:3 = 0
ELSEIF SOURCE:21 < 3000
	LOCAL:3 = 100
ELSEIF SOURCE:21 < 6000
	LOCAL:3 = 200
ELSEIF SOURCE:21 < 10000
	LOCAL:3 = 300
ELSEIF SOURCE:21 < 18000
	LOCAL:3 = 600
ELSEIF SOURCE:21 < 30000
	LOCAL:3 = 1200
ELSE
	LOCAL:3 = 2400
ENDIF
SIF LOCAL:3 > 300
	LOCAL:3 += SOURCE:21

;ABL:マゾっ気을 본다
IF ABL:21 == 0
	TIMES LOCAL , 0.50
	TIMES LOCAL:2 , 3.00
	TIMES LOCAL:3 , 3.00
ELSEIF ABL:21 == 1
	TIMES LOCAL , 0.80
	TIMES LOCAL:2 , 1.50
	TIMES LOCAL:3 , 1.50
ELSEIF ABL:21 == 2
	TIMES LOCAL , 1.00
	TIMES LOCAL:2 , 1.00
	TIMES LOCAL:3 , 1.00
ELSEIF ABL:21 == 3
	TIMES LOCAL , 1.20
	TIMES LOCAL:2 , 0.50
	TIMES LOCAL:3 , 0.50
ELSEIF ABL:21 == 4
	TIMES LOCAL , 1.50
	TIMES LOCAL:2 , 0.10
	TIMES LOCAL:3 , 0.10
ELSE
	TIMES LOCAL , 1.80
	TIMES LOCAL:2 , 0.02
	TIMES LOCAL:3 , 0.02
ENDIF

;ABL:自慰中毒을 본다
IF ABL:30 == 0
	TIMES LOCAL , 0.50
	TIMES LOCAL:1 , 0.10
	TIMES LOCAL:2 , 0.50
	TIMES LOCAL:3 , 0.50
ELSEIF ABL:30 == 1
	TIMES LOCAL , 0.80
	TIMES LOCAL:1 , 0.50
	TIMES LOCAL:2 , 0.80
	TIMES LOCAL:3 , 0.80
ELSEIF ABL:30 == 2
	TIMES LOCAL , 1.00
	TIMES LOCAL:1 , 1.00
	TIMES LOCAL:2 , 1.00
	TIMES LOCAL:3 , 1.00
ELSEIF ABL:30 == 3
	TIMES LOCAL , 1.20
	TIMES LOCAL:1 , 1.50
	TIMES LOCAL:2 , 1.30
	TIMES LOCAL:3 , 1.50
ELSEIF ABL:30 == 4
	TIMES LOCAL , 1.50
	TIMES LOCAL:1 , 1.80
	TIMES LOCAL:2 , 1.60
	TIMES LOCAL:3 , 2.00
ELSE
	TIMES LOCAL , 1.80
	TIMES LOCAL:1 , 2.50
	TIMES LOCAL:2 , 2.00
	TIMES LOCAL:3 , 2.50
ENDIF

;濡れやすい
IF TALENT:42
	TIMES LOCAL , 1.50
	TIMES LOCAL:1 , 1.50
	TIMES LOCAL:2 , 2.50
;濡れにくい
ELSEIF TALENT:43
	TIMES LOCAL , 0.80
	TIMES LOCAL:1 , 1.20
	TIMES LOCAL:2 , 1.50
ENDIF
;倒錯的
IF TALENT:80
	TIMES LOCAL , 1.50
	TIMES LOCAL:1 , 0.50
	TIMES LOCAL:2 , 0.80
ENDIF
;マゾ
IF TALENT:82
	TIMES LOCAL , 1.50
	TIMES LOCAL:2 , 1.50
	TIMES LOCAL:3 , 0.50
ENDIF
;淫乱
IF TALENT:170
	TIMES LOCAL , 1.50
	TIMES LOCAL:1 , 1.80
	TIMES LOCAL:2 , 1.80
	TIMES LOCAL:3 , 1.20
ENDIF

;調教者がサド
IF TALENT:PLAYER:81
	TIMES LOCAL , 2.00
	TIMES LOCAL:1 , 1.20
	TIMES LOCAL:2 , 2.50
ENDIF

UP:13 += LOCAL
UP:16 += LOCAL
UP:14 += LOCAL:1
UP:21 += LOCAL:2
UP:20 += LOCAL:3

;-------------------------------------------------
;屈従의 소스
;-------------------------------------------------
@CALC_SOURCE22
LOCAL = SOURCE:22
LOCAL:1 = SOURCE:22

;ABL:순종을 본다
IF ABL:10 == 0
	TIMES LOCAL , 0.50
	TIMES LOCAL:1 , 0.12
ELSEIF ABL:10 == 1
	TIMES LOCAL , 0.80
	TIMES LOCAL:1 , 0.10
ELSEIF ABL:10 == 2
	TIMES LOCAL , 1.00
	TIMES LOCAL:1 , 0.05
ELSEIF ABL:10 == 3
	TIMES LOCAL , 1.10
	TIMES LOCAL:1 , 0.02
ELSEIF ABL:10 == 4
	TIMES LOCAL , 1.20
	TIMES LOCAL:1 , 0.00
ELSE
	TIMES LOCAL , 1.30
	TIMES LOCAL:1 , 0.00
ENDIF

;ABL:サドっ気을 본다
IF ABL:20 == 0
	TIMES LOCAL , 1.00
	TIMES LOCAL:1 , 1.00
ELSEIF ABL:20 == 1
	TIMES LOCAL , 1.20
	TIMES LOCAL:1 , 0.80
ELSEIF ABL:20 == 2
	TIMES LOCAL , 1.40
	TIMES LOCAL:1 , 0.60
ELSEIF ABL:20 == 3
	TIMES LOCAL , 1.60
	TIMES LOCAL:1 , 0.50
ELSEIF ABL:20 == 4
	TIMES LOCAL , 1.80
	TIMES LOCAL:1 , 0.40
ELSE
	TIMES LOCAL , 2.00
	TIMES LOCAL:1 , 0.25
ENDIF

;パイパン
IF TALENT:65
	SIF TALENT:128 == 0
		TIMES LOCAL , 1.80
	TIMES LOCAL:1 , 1.50
ENDIF

;クリトリスリング
IF CFLAG:42 & 1
	TIMES LOCAL , 1.40
	TIMES LOCAL:1 , 1.25
ENDIF
;ラビアピアス
IF CFLAG:42 & 16
	TIMES LOCAL , 1.50
	TIMES LOCAL:1 , 1.30
ENDIF
;ニプルピアス
IF CFLAG:42 & 32
	TIMES LOCAL , 1.30
	TIMES LOCAL:1 , 1.20
ENDIF

UP:14 += LOCAL
UP:22 += LOCAL:1

;-------------------------------------------------
;支配의 소스
;-------------------------------------------------
;LOCAL:0=屈服,恐怖
;LOCAL:1=抑鬱
;LOCAL:2=反感
;LOCAL:3=욕정
@CALC_SOURCE23

LOCAL = SOURCE:23
LOCAL:1 = SOURCE:23
LOCAL:2 = SOURCE:23
LOCAL:3 = SOURCE:23

;ABL:순종을 본다
IF ABL:10 == 0
	TIMES LOCAL , 0.50
	TIMES LOCAL:1 , 2.50
	TIMES LOCAL:2 , 2.00
ELSEIF ABL:10 == 1
	TIMES LOCAL , 0.80
	TIMES LOCAL:1 , 2.00
	TIMES LOCAL:2 , 1.50
ELSEIF ABL:10 == 2
	TIMES LOCAL , 1.00
	TIMES LOCAL:1 , 1.50
	TIMES LOCAL:2 , 1.20
ELSEIF ABL:10 == 3
	TIMES LOCAL , 1.10
	TIMES LOCAL:1 , 1.20
	TIMES LOCAL:2 , 1.00
ELSEIF ABL:10 == 4
	TIMES LOCAL , 1.20
	TIMES LOCAL:1 , 1.00
	TIMES LOCAL:2 , 0.80
ELSE
	TIMES LOCAL , 1.30
	TIMES LOCAL:1 , 0.60
	TIMES LOCAL:2 , 0.50
ENDIF

;ABL:サドっ気을 본다
IF ABL:20 == 0
	TIMES LOCAL:2 , 1.00
	TIMES LOCAL:3 , 0.20
ELSEIF ABL:20 == 1
	TIMES LOCAL:2 , 1.20
	TIMES LOCAL:3 , 0.50
ELSEIF ABL:20 == 2
	TIMES LOCAL:2 , 1.50
	TIMES LOCAL:3 , 0.80
ELSEIF ABL:20 == 3
	TIMES LOCAL:2 , 1.80
	TIMES LOCAL:3 , 1.00
ELSEIF ABL:20 == 4
	TIMES LOCAL:2 , 2.00
	TIMES LOCAL:3 , 1.30
ELSE
	TIMES LOCAL:2 , 2.50
	TIMES LOCAL:3 , 1.60
ENDIF

;ABL:マゾっ気을 본다
IF ABL:21 == 0
	TIMES LOCAL:2 , 1.00
	TIMES LOCAL:3 , 0.00
ELSEIF ABL:21 == 1
	TIMES LOCAL:2 , 0.80
	TIMES LOCAL:3 , 0.10
ELSEIF ABL:21 == 2
	TIMES LOCAL:2 , 0.50
	TIMES LOCAL:3 , 0.20
ELSEIF ABL:21 == 3
	TIMES LOCAL:2 , 0.30
	TIMES LOCAL:3 , 0.30
ELSEIF ABL:21 == 4
	TIMES LOCAL:2 , 0.10
	TIMES LOCAL:3 , 0.45
ELSE
	TIMES LOCAL:2 , 0.05
	TIMES LOCAL:3 , 0.60
ENDIF

;臆病
IF TALENT:10
	TIMES LOCAL , 3.00
	TIMES LOCAL:1 , 0.50
	TIMES LOCAL:2 , 0.50
ENDIF
;反抗的
IF TALENT:11
	TIMES LOCAL , 0.70
	TIMES LOCAL:1 , 1.50
	TIMES LOCAL:2 , 1.50
ENDIF
;プライド高い
IF TALENT:16
	TIMES LOCAL , 0.70
	TIMES LOCAL:1 , 1.30
	TIMES LOCAL:2 , 1.30
;プライド低い
ELSEIF TALENT:17
	TIMES LOCAL , 1.30
	TIMES LOCAL:1 , 0.90
	TIMES LOCAL:2 , 0.90
ENDIF
;自制心
IF TALENT:20
	TIMES LOCAL:1 , 0.80
	TIMES LOCAL:2 , 0.80
ENDIF
;悲観的
IF TALENT:26
	TIMES LOCAL , 1.50
	TIMES LOCAL:1 , 1.50
ENDIF
;弱味
IF TALENT:39
	TIMES LOCAL , 1.50
	TIMES LOCAL:2 , 0.80
ENDIF
;献身的
IF TALENT:63
	TIMES LOCAL , 1.80
	TIMES LOCAL:1 , 1.50
ENDIF
;倒錯的
IF TALENT:80
	TIMES LOCAL , 2.00
	TIMES LOCAL:1 , 0.50
	TIMES LOCAL:2 , 0.80
	TIMES LOCAL:3 , 2.00
ENDIF
;マゾ
IF TALENT:82
	TIMES LOCAL , 1.50
	TIMES LOCAL:3 , 1.50
ENDIF

;調教者がサド
IF TALENT:PLAYER:81
	TIMES LOCAL , 2.00
	TIMES LOCAL:1 , 0.80
	TIMES LOCAL:2 , 1.20
ENDIF

;ABL:調教者のサドっ気을 본다
IF ABL:PLAYER:20 == 0
	TIMES LOCAL , 1.00
	TIMES LOCAL:2 , 1.00
ELSEIF ABL:PLAYER:20 <= 2
	TIMES LOCAL , 1.10
	TIMES LOCAL:2 , 1.20
ELSEIF ABL:PLAYER:20 <= 4
	TIMES LOCAL , 1.20
	TIMES LOCAL:2 , 1.40
ELSE
	TIMES LOCAL , 1.40
	TIMES LOCAL:2 , 1.80
ENDIF

;クリトリスリング
IF CFLAG:42 & 1
	TIMES LOCAL , 1.25
	TIMES LOCAL:1 , 1.25
	TIMES LOCAL:2 , 1.25
ENDIF
;ラビアピアス
IF CFLAG:42 & 16
	TIMES LOCAL , 1.30
	TIMES LOCAL:1 , 1.30
	TIMES LOCAL:2 , 1.30
ENDIF
;ニプルピアス
IF CFLAG:42 & 32
	TIMES LOCAL , 1.20
	TIMES LOCAL:1 , 1.20
	TIMES LOCAL:2 , 1.20
ENDIF

UP:17 += LOCAL

;服従
IF TALENT:160
	TIMES LOCAL , 1.80
	TIMES LOCAL:1 , 0.50
	TIMES LOCAL:2 , 0.50
ENDIF
;烙印
IF TALENT:161
	TIMES LOCAL , 2.00
	TIMES LOCAL:1 , 0.10
	TIMES LOCAL:2 , 0.10
ENDIF
;隷属
IF TALENT:162
	TIMES LOCAL , 1.80
	TIMES LOCAL:1 , 0.10
	TIMES LOCAL:2 , 0.10
	TIMES LOCAL:3 , 1.50
ENDIF

UP:14 += LOCAL
UP:22 += LOCAL:1
UP:20 += LOCAL:2
UP:13 += LOCAL:3

;-------------------------------------------------
;中毒充足의 소스
;-------------------------------------------------
@CALC_SOURCE24
LOCAL = SOURCE:24
LOCAL:1 = SOURCE:24

;ABL:욕망을 본다
IF ABL:11 == 0
	TIMES LOCAL , 0.10
	TIMES LOCAL:1 , 0.20
ELSEIF ABL:11 == 1
	TIMES LOCAL , 0.15
	TIMES LOCAL:1 , 0.30
ELSEIF ABL:11 == 2
	TIMES LOCAL , 0.20
	TIMES LOCAL:1 , 0.40
ELSEIF ABL:11 == 3
	TIMES LOCAL , 0.25
	TIMES LOCAL:1 , 0.50
ELSEIF ABL:11 == 4
	TIMES LOCAL , 0.30
	TIMES LOCAL:1 , 0.60
ELSE
	TIMES LOCAL , 0.35
	TIMES LOCAL:1 , 0.70
ENDIF

;マゾ
IF TALENT:82
	TIMES LOCAL , 1.20
	TIMES LOCAL:1 , 1.50
ENDIF

UP:12 += LOCAL
UP:13 += LOCAL:1

;-------------------------------------------------
;トラウマ의 소스
;-------------------------------------------------
;LOCAL:0=屈服, LOCAL:1=恐怖, LOCAL:2=不快
@CALC_SOURCE25
LOCAL = SOURCE:25
LOCAL:1 = SOURCE:25
LOCAL:2 = SOURCE:25

;MARK:恐怖刻印을 본다
IF MARK:8 == 0
	TIMES LOCAL , 0.50
	TIMES LOCAL:1 , 0.25
	TIMES LOCAL:2 , 0.30
ELSEIF MARK:8 == 1
	TIMES LOCAL , 0.75
	TIMES LOCAL:1 , 1.00
	TIMES LOCAL:2 , 0.60
ELSEIF MARK:8 == 2
	TIMES LOCAL , 1.00
	TIMES LOCAL:1 , 1.50
	TIMES LOCAL:2 , 1.00
ELSE
	TIMES LOCAL , 1.25
	TIMES LOCAL:1 , 3.00
	TIMES LOCAL:2 , 1.50
ENDIF

;臆病
IF TALENT:10
	TIMES LOCAL , 1.50
	TIMES LOCAL:1 , 1.80
	TIMES LOCAL:2 , 7.50
ENDIF

UP:14 += LOCAL
UP:17 += LOCAL:1
UP:21 += LOCAL:2

;-------------------------------------------------
;薬物侵蝕의 소스
;-------------------------------------------------
;LOCAL:0=욕정, LOCAL:1=不快, LOCAL:2=薬毒
@CALC_SOURCE26
;薬毒耐性
SIF TALENT:44
	TIMES SOURCE:26 , 0.25
;媚薬中毒
SIF TALENT:46
	TIMES SOURCE:26 , 1.50
;機械
SIF TALENT:206
	TIMES SOURCE:26 , 0.25
;霊体または人形
SIF TALENT:207 || TALENT:208
	TIMES SOURCE:26 , 0.50

LOCAL = SOURCE:26
LOCAL:1 = SOURCE:26
LOCAL:2 = SOURCE:26

;ABL:순종을 본다
IF ABL:10 == 0
	TIMES LOCAL , 0.10
	TIMES LOCAL:1 , 2.00
	TIMES LOCAL:2 , 0.10
ELSEIF ABL:10 == 1
	TIMES LOCAL , 0.30
	TIMES LOCAL:1 , 1.50
	TIMES LOCAL:2 , 0.40
ELSEIF ABL:10 == 2
	TIMES LOCAL , 0.50
	TIMES LOCAL:1 , 1.00
	TIMES LOCAL:2 , 0.70
ELSEIF ABL:10 == 3
	TIMES LOCAL , 0.80
	TIMES LOCAL:1 , 0.70
	TIMES LOCAL:2 , 1.00
ELSEIF ABL:10 == 4
	TIMES LOCAL , 1.00
	TIMES LOCAL:1 , 0.40
	TIMES LOCAL:2 , 1.50
ELSE
	TIMES LOCAL , 1.50
	TIMES LOCAL:1 , 0.10
	TIMES LOCAL:2 , 2.00
ENDIF

;ABL:○○中毒関係을 본다
IF TALENT:120
	LOCAL:3 = (ABL:30+ABL:31+ABL:33+ABL:34+ABL:35+ABL:36+ABL:37)/5
ELSE
	LOCAL:3 = (ABL:30+ABL:31+ABL:32+ABL:34+ABL:35+ABL:36+ABL:37)/5
ENDIF
IF LOCAL:3 == 0
	TIMES LOCAL , 0.50
	TIMES LOCAL:1 , 2.50
	TIMES LOCAL:2 , 0.80
ELSEIF LOCAL:3 == 1
	TIMES LOCAL , 0.80
	TIMES LOCAL:1 , 1.80
	TIMES LOCAL:2 , 1.00
ELSEIF LOCAL:3 == 2
	TIMES LOCAL , 1.00
	TIMES LOCAL:1 , 1.50
	TIMES LOCAL:2 , 1.10
ELSEIF LOCAL:3 == 3
	TIMES LOCAL , 1.20
	TIMES LOCAL:1 , 1.00
	TIMES LOCAL:2 , 1.30
ELSEIF LOCAL:3 == 4
	TIMES LOCAL , 1.50
	TIMES LOCAL:1 , 0.50
	TIMES LOCAL:2 , 1.60
ELSE
	TIMES LOCAL , 1.80
	TIMES LOCAL:1 , 0.10
	TIMES LOCAL:2 , 2.00
ENDIF

;喘息
SIF TARGET:47
	TIMES LOCAL:2 , 1.50

;MARK:反発刻印을 본다
IF MARK:9 == 0
	TIMES LOCAL , 1.25
	TIMES LOCAL:1 , 0.25
	TIMES LOCAL:2 , 0.50
ELSEIF MARK:9 == 1
	TIMES LOCAL , 1.00
	TIMES LOCAL:1 , 1.00
	TIMES LOCAL:2 , 1.00
ELSEIF MARK:9 == 2
	TIMES LOCAL , 0.75
	TIMES LOCAL:1 , 1.50
	TIMES LOCAL:2 , 1.50
ELSE
	TIMES LOCAL , 0.50
	TIMES LOCAL:1 , 3.00
	TIMES LOCAL:2 , 2.00
ENDIF

;MARK:薬物刻印을 본다
IF MARK:3 == 0
	TIMES LOCAL , 0.50
	TIMES LOCAL:1 , 2.00
	TIMES LOCAL:2 , 1.00
ELSEIF MARK:3 == 1
	TIMES LOCAL , 0.75
	TIMES LOCAL:1 , 1.00
	TIMES LOCAL:2 , 1.50
ELSEIF MARK:3 == 2
	TIMES LOCAL , 1.00
	TIMES LOCAL:1 , 0.50
	TIMES LOCAL:2 , 2.00
ELSE
	TIMES LOCAL , 1.75
	TIMES LOCAL:1 , 0.10
	LOCAL:2 = 0
ENDIF

UP:13 += LOCAL
UP:21 += LOCAL:1
UP:30 += LOCAL:2

;-------------------------------------------------
;触手汚染의 소스
;-------------------------------------------------
@CALC_SOURCE27
LOCAL = SOURCE:27
LOCAL:1 = SOURCE:27
LOCAL:2 = SOURCE:27

;EXP:触手経験을 본다
IF EXP:53 < EXPLV:1
	TIMES LOCAL , 0.80
	TIMES LOCAL:1 , 2.00
	TIMES LOCAL:2 , 0.60
ELSEIF EXP:53 < EXPLV:2
	TIMES LOCAL , 0.90
	TIMES LOCAL:1 , 1.50
	TIMES LOCAL:2 , 0.80
ELSEIF EXP:53 < EXPLV:3
	TIMES LOCAL , 1.00
	TIMES LOCAL:1 , 1.00
	TIMES LOCAL:2 , 1.00
ELSEIF EXP:53 < EXPLV:4
	TIMES LOCAL , 1.20
	TIMES LOCAL:1 , 0.75
	TIMES LOCAL:2 , 2.00
ELSEIF EXP:53 < EXPLV:5
	TIMES LOCAL , 1.50
	TIMES LOCAL:1 , 0.50
	TIMES LOCAL:2 , 2.50
ELSE
	TIMES LOCAL , 2.00
	TIMES LOCAL:1 , 0.25
	TIMES LOCAL:2 , 3.00
ENDIF

;ABL:触手中毒을 본다
IF ABL:35 == 0
	TIMES LOCAL , 0.50
	TIMES LOCAL:1 , 3.50
	TIMES LOCAL:2 , 0.50
ELSEIF ABL:35 == 1
	TIMES LOCAL , 0.60
	TIMES LOCAL:1 , 2.00
	TIMES LOCAL:2 , 0.60
ELSEIF ABL:35 == 2
	TIMES LOCAL , 0.70
	TIMES LOCAL:1 , 1.00
	TIMES LOCAL:2 , 0.70
ELSEIF ABL:35 == 3
	TIMES LOCAL , 0.80
	TIMES LOCAL:1 , 0.50
	TIMES LOCAL:2 , 0.80
ELSEIF ABL:35 == 4
	TIMES LOCAL , 0.90
	TIMES LOCAL:1 , 0.10
	TIMES LOCAL:2 , 0.90
ELSE
	TIMES LOCAL , 1.00
	TIMES LOCAL:1 , 0.00
	TIMES LOCAL:2 , 1.00
ENDIF

;触手寄生LVの最大値に対する現在値の割合([寄生]が無い場合は0％扱い)
LOCAL:3 = (TALENT:146) ? (BASE:6 *100) / MAXBASE:6 # 0
IF LOCAL:3 == 0
	TIMES LOCAL , 1.00
	TIMES LOCAL:1 , 1.00
	TIMES LOCAL:2 , 1.00
ELSEIF LOCAL:3 < 20
	TIMES LOCAL , 1.10
	TIMES LOCAL:1 , 0.90
	TIMES LOCAL:2 , 1.25
ELSEIF LOCAL:3 < 40
	TIMES LOCAL , 1.30
	TIMES LOCAL:1 , 0.75
	TIMES LOCAL:2 , 1.50
ELSEIF LOCAL:3 < 60
	TIMES LOCAL , 1.50
	TIMES LOCAL:1 , 0.60
	TIMES LOCAL:2 , 1.80
ELSEIF LOCAL:3 < 80
	TIMES LOCAL , 1.70
	TIMES LOCAL:1 , 0.20
	TIMES LOCAL:2 , 2.20
ELSEIF LOCAL:3 < 100
	TIMES LOCAL , 1.90
	TIMES LOCAL:1 , 0.10
	TIMES LOCAL:2 , 2.50
ELSE
	TIMES LOCAL , 2.50
	TIMES LOCAL:1 , 0.00
	TIMES LOCAL:2 , 3.00
ENDIF

UP:14 += LOCAL
UP:21 += LOCAL:1

;侵蝕はそのコマンドの절정強度(回数)で増加
;増加量は調教者の触手使役Lvに依存
IF ABL:PLAYER:98 == 0
	LOCAL:4 = 5
ELSEIF ABL:PLAYER:98 == 1
	LOCAL:4 = 10
ELSEIF ABL:PLAYER:98 == 2
	LOCAL:4 = 25
ELSEIF ABL:PLAYER:98 == 3
	LOCAL:4 = 50
ELSEIF ABL:PLAYER:98 == 4
	LOCAL:4 = 75
ELSE
	LOCAL:4 = 100
ENDIF
REPEAT 4
	SIF NOWEX:COUNT
		LOCAL:2 += NOWEX:COUNT * LOCAL:4
	SIF NOWEX:(COUNT+10)
		LOCAL:2 += NOWEX:(COUNT+10) * (LOCAL:4 * 2)
REND

UP:31 += LOCAL:2

;-------------------------------------------------
;羞恥扇情의 소스
;-------------------------------------------------
@CALC_SOURCE28
LOCAL = SOURCE:28
LOCAL:1 = SOURCE:28
LOCAL:2 = SOURCE:28

;MARK:恥辱刻印을 본다
IF MARK:4 == 0
	TIMES LOCAL , 0.50
	TIMES LOCAL:1 , 0.75
	TIMES LOCAL:2 , 2.00
ELSEIF MARK:4 == 1
	TIMES LOCAL , 0.75
	TIMES LOCAL:1 , 1.00
	TIMES LOCAL:2 , 1.00
ELSEIF MARK:4 == 2
	TIMES LOCAL , 1.00
	TIMES LOCAL:1 , 1.50
	TIMES LOCAL:2 , 0.50
ELSE
	TIMES LOCAL , 1.50
	TIMES LOCAL:1 , 2.00
	TIMES LOCAL:2 , 0.25
ENDIF

UP:14 += LOCAL
UP:15 += LOCAL:1
UP:31 += LOCAL:2

;-------------------------------------------------
;성기술 학습의 소스
;-------------------------------------------------
@CALC_SOURCE29
LOCAL = SOURCE:29
LOCAL:1 = SOURCE:29
LOCAL:2 = SOURCE:29

;ABL:봉사정신을 본다
IF ABL:13 == 0
	TIMES LOCAL , 0.20
	TIMES LOCAL:1 , 1.00
ELSEIF ABL:13 == 1
	TIMES LOCAL , 0.40
	TIMES LOCAL:1 , 0.90
ELSEIF ABL:13 == 2
	TIMES LOCAL , 0.80
	TIMES LOCAL:1 , 0.80
ELSEIF ABL:13 == 3
	TIMES LOCAL , 1.00
	TIMES LOCAL:1 , 0.70
ELSEIF ABL:13 == 4
	TIMES LOCAL , 1.50
	TIMES LOCAL:1 , 0.60
ELSE
	TIMES LOCAL , 1.80
	TIMES LOCAL:1 , 0.50
ENDIF

;ABL:노출벽을 본다
IF ABL:14 == 0
	TIMES LOCAL , 1.00
	TIMES LOCAL:2 , 1.50
ELSEIF ABL:14 == 1
	TIMES LOCAL , 1.10
	TIMES LOCAL:2 , 1.25
ELSEIF ABL:14 == 2
	TIMES LOCAL , 1.20
	TIMES LOCAL:2 , 1.00
ELSEIF ABL:14 == 3
	TIMES LOCAL , 1.30
	TIMES LOCAL:2 , 0.75
ELSEIF ABL:14 == 4
	TIMES LOCAL , 1.40
	TIMES LOCAL:2 , 0.50
ELSE
	TIMES LOCAL , 1.50
	TIMES LOCAL:2 , 0.10
ENDIF

UP:11 += LOCAL
UP:14 += LOCAL:1
UP:31 += LOCAL:2

;-------------------------------------------------
;불결의 소스
;-------------------------------------------------
@CALC_SOURCE30
LOCAL = SOURCE:30
LOCAL:1 = SOURCE:30

;ABL:순종을 본다
IF ABL:10 == 0
	TIMES LOCAL , 1.60
	TIMES LOCAL:1 , 1.40
ELSEIF ABL:10 == 1
	TIMES LOCAL , 1.30
	TIMES LOCAL:1 , 1.20
ELSEIF ABL:10 == 2
	TIMES LOCAL , 1.10
	TIMES LOCAL:1 , 1.00
ELSEIF ABL:10 == 3
	TIMES LOCAL , 1.00
	TIMES LOCAL:1 , 0.80
ELSEIF ABL:10 == 4
	TIMES LOCAL , 0.80
	TIMES LOCAL:1 , 0.50
ELSE
	TIMES LOCAL , 0.50
	TIMES LOCAL:1 , 0.10
ENDIF

;ABL:排泄中毒을 본다
IF ABL:36 == 0
	TIMES LOCAL , 0.60
	TIMES LOCAL:1 , 1.00
ELSEIF ABL:36 == 1
	TIMES LOCAL , 0.40
	TIMES LOCAL:1 , 0.80
ELSEIF ABL:36 == 2
	TIMES LOCAL , 0.25
	TIMES LOCAL:1 , 0.60
ELSEIF ABL:36 == 3
	TIMES LOCAL , 0.10
	TIMES LOCAL:1 , 0.30
ELSEIF ABL:36 == 4
	TIMES LOCAL , 0.00
	TIMES LOCAL:1 , 0.10
ELSE
	TIMES LOCAL , 0.00
	TIMES LOCAL:1 , 0.00
ENDIF

UP:20 += LOCAL
UP:21 += LOCAL:1

;-------------------------------------------------
;일탈의 소스
;-------------------------------------------------
@CALC_SOURCE31
;好奇心と保守的はここで処理
SIF TALENT:23
	TIMES SOURCE:31 , 0.30
SIF TALENT:24
	TIMES SOURCE:31 , 3.00

LOCAL = SOURCE:31

;ABL:순종을 본다
IF ABL:10 == 0
	TIMES LOCAL , 1.00
ELSEIF ABL:10 == 1
	TIMES LOCAL , 0.80
ELSEIF ABL:10 == 2
	TIMES LOCAL , 0.70
ELSEIF ABL:10 == 3
	TIMES LOCAL , 0.40
ELSEIF ABL:10 == 4
	TIMES LOCAL , 0.20
ELSE
	TIMES LOCAL , 0.00
ENDIF

;ABL:욕망을 본다
IF ABL:11 == 0
	TIMES LOCAL , 0.90
ELSEIF ABL:11 == 1
	TIMES LOCAL , 0.70
ELSEIF ABL:11 == 2
	TIMES LOCAL , 0.50
ELSEIF ABL:11 == 3
	TIMES LOCAL , 0.30
ELSEIF ABL:11 == 4
	TIMES LOCAL , 0.10
ELSE
	TIMES LOCAL , 0.00
ENDIF

;パイパン(小人体型もしくは小柄体型は除く)
SIF TALENT:65 && TALENT:127 == 0 && TALENT:128 == 0
	TIMES LOCAL , 1.80
;マゾ
SIF TALENT:82
	TIMES LOCAL , 0.50

;クリトリスリング
SIF CFLAG:42 & 1
	TIMES LOCAL , 1.25
;ラビアピアス
SIF CFLAG:42 & 16
	TIMES LOCAL , 1.30
;ニプルピアス
SIF CFLAG:42 & 32
	TIMES LOCAL , 1.20

UP:20 += LOCAL

;-------------------------------------------------
;반감 추가의 소스
;-------------------------------------------------
@CALC_SOURCE32
LOCAL = SOURCE:32

;흠집
SIF TALENT:163
	TIMES LOCAL , 2.50

UP:20 += LOCAL

;-------------------------------------------------
;酒酔い의 소스
;-------------------------------------------------
@CALC_SOURCE40
LOCAL = SOURCE:40
LOCAL:1 = SOURCE:40 * 4
LOCAL:2 = SOURCE:40 * 2

;PALAM:욕정을 본다
IF PALAM:13 < PALAMLV:1
	TIMES LOCAL , 1.00
	TIMES LOCAL:1 , 0.50
	TIMES LOCAL:2 , 1.00
ELSEIF PALAM:13 < PALAMLV:2
	TIMES LOCAL , 1.20
	TIMES LOCAL:1 , 0.70
	TIMES LOCAL:2 , 0.75
ELSEIF PALAM:13 < PALAMLV:3
	TIMES LOCAL , 1.50
	TIMES LOCAL:1 , 1.00
	TIMES LOCAL:2 , 0.50
ELSEIF PALAM:13 < PALAMLV:4
	TIMES LOCAL , 1.80
	TIMES LOCAL:1 , 1.30
	TIMES LOCAL:2 , 0.25
ELSE
	TIMES LOCAL , 2.50
	TIMES LOCAL:1 , 1.80
	TIMES LOCAL:2 , 0.10
ENDIF

;人形
SIF TALENT:208
	TIMES LOCAL , 0.75
;河童
SIF TALENT:210
	TIMES LOCAL , 0.75
;鬼
SIF TALENT:214
	TIMES LOCAL , 0.25
;天狗
SIF TALENT:215
	TIMES LOCAL , 0.75
;黄昏の怪物
SIF TALENT:221
	TIMES LOCAL , 0.25
;神霊
SIF TALENT:222
	TIMES LOCAL , 0.75
;半神
SIF TALENT:223
	TIMES LOCAL , 0.75

BASE:8 += LOCAL
UP:13 += LOCAL:1
UP:21 += LOCAL:2

;-------------------------------------------------
;酒酔い(鬼殺し)의 소스
;-------------------------------------------------
@CALC_SOURCE41
LOCAL = SOURCE:41
LOCAL:1 = SOURCE:41 * 4
LOCAL:2 = SOURCE:41 * 2
LOCAL:3 = SOURCE:41 * 3

;PALAM:욕정을 본다
IF PALAM:13 < PALAMLV:1
	TIMES LOCAL , 1.00
	TIMES LOCAL:1 , 0.50
	TIMES LOCAL:2 , 1.00
	TIMES LOCAL:3 , 0.50
ELSEIF PALAM:13 < PALAMLV:2
	TIMES LOCAL , 1.20
	TIMES LOCAL:1 , 0.70
	TIMES LOCAL:2 , 0.75
	TIMES LOCAL:3 , 0.80
ELSEIF PALAM:13 < PALAMLV:3
	TIMES LOCAL , 1.50
	TIMES LOCAL:1 , 1.00
	TIMES LOCAL:2 , 0.50
	TIMES LOCAL:3 , 1.00
ELSEIF PALAM:13 < PALAMLV:4
	TIMES LOCAL , 1.80
	TIMES LOCAL:1 , 1.30
	TIMES LOCAL:2 , 0.25
	TIMES LOCAL:3 , 1.30
ELSE
	TIMES LOCAL , 2.50
	TIMES LOCAL:1 , 1.80
	TIMES LOCAL:2 , 0.10
	TIMES LOCAL:3 , 1.60
ENDIF

;人形
SIF TALENT:208
	TIMES LOCAL , 0.75
;河童
SIF TALENT:210
	TIMES LOCAL , 0.75
;天狗
SIF TALENT:215
	TIMES LOCAL , 0.75
;鬼
SIF TALENT:214
	TIMES LOCAL , 2.50
;黄昏の怪物
SIF TALENT:221
	TIMES LOCAL , 0.25
;神霊
SIF TALENT:222
	TIMES LOCAL , 0.75
;半神
SIF TALENT:223
	TIMES LOCAL , 0.75

BASE:8 += LOCAL
UP:13 += LOCAL:1
UP:21 += LOCAL:2
UP:30 += LOCAL:3

;-------------------------------------------------
;媚薬浸潤의 소스
;-------------------------------------------------
@CALC_SOURCE42, ARG
LOCAL = SOURCE:ARG:42

;中毒しやすい
IF TALENT:ARG:84
	TIMES LOCAL , 1.25
;中毒しにくい
ELSEIF TALENT:ARG:85
	TIMES LOCAL , 0.75
ENDIF

;媚薬中毒
IF TALENT:ARG:46
	UP:12 += LOCAL*2
	UP:13 += LOCAL
	UP:14 += LOCAL*3
	CFLAG:ARG:32 = 0
ELSE
	;媚薬中毒レベルの上昇処理
	CFLAG:ARG:32 += SOURCE:ARG:42
ENDIF
